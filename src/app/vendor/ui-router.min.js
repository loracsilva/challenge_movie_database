! function(t, e) {
  "object" == typeof exports && "undefined" != typeof module ? e(exports, require("angular")) : "function" == typeof define && define.amd ? define(["exports", "angular"], e) : e(t["@uirouter/angularjs"] = t["@uirouter/angularjs"] || {}, t.angular)
}(this, function(t, e) {
  "use strict";
  var r = angular,
    n = e && e.module ? e : r;

  function i(t) {
    var e = [].slice.apply(arguments, [1]),
      r = t.length;
    return function e(n) {
      return n.length >= r ? t.apply(null, n) : function() {
        return e(n.concat([].slice.apply(arguments)))
      }
    }(e)
  }

  function o() {
    var t = arguments,
      e = t.length - 1;
    return function() {
      for (var r = e, n = t[e].apply(this, arguments); r--;) n = t[r].call(this, n);
      return n
    }
  }

  function a() {
    for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
    return o.apply(null, [].slice.call(arguments).reverse())
  }
  var u = function(t) {
      return function(e) {
        return e && e[t]
      }
    },
    s = i(function(t, e, r) {
      return r && r[t] === e
    }),
    c = function(t) {
      return a.apply(null, t.split(".").map(u))
    },
    f = function(t) {
      return function() {
        for (var e = [], r = 0; r < arguments.length; r++) e[r] = arguments[r];
        return !t.apply(null, e)
      }
    };

  function l(t, e) {
    return function() {
      for (var r = [], n = 0; n < arguments.length; n++) r[n] = arguments[n];
      return t.apply(null, r) && e.apply(null, r)
    }
  }

  function h(t, e) {
    return function() {
      for (var r = [], n = 0; n < arguments.length; n++) r[n] = arguments[n];
      return t.apply(null, r) || e.apply(null, r)
    }
  }
  var p = function(t) {
      return function(e) {
        return e.reduce(function(e, r) {
          return e && !!t(r)
        }, !0)
      }
    },
    d = function(t) {
      return function(e) {
        return e.reduce(function(e, r) {
          return e || !!t(r)
        }, !1)
      }
    },
    v = function(t) {
      return function(e) {
        return null != e && e.constructor === t || e instanceof t
      }
    },
    m = function(t) {
      return function(e) {
        return t === e
      }
    },
    y = function(t) {
      return function() {
        return t
      }
    };

  function g(t, e) {
    return function(r) {
      return r[t].apply(r, e)
    }
  }

  function w(t) {
    return function(e) {
      for (var r = 0; r < t.length; r++)
        if (t[r][0](e)) return t[r][1](e)
    }
  }
  var _ = function() {
      function t(t) {
        this.text = t, this.glob = t.split(".");
        var e = this.text.split(".").map(function(t) {
          return "**" === t ? "(?:|(?:\\.[^.]*)*)" : "*" === t ? "\\.[^.]*" : "\\." + t
        }).join("");
        this.regexp = new RegExp("^" + e + "$")
      }
      return t.prototype.matches = function(t) {
        return this.regexp.test("." + t)
      }, t.is = function(t) {
        return !!/[!,*]+/.exec(t)
      }, t.fromString = function(e) {
        return t.is(e) ? new t(e) : null
      }, t
    }(),
    $ = function() {
      function t(e) {
        return t.create(e || {})
      }
      return t.create = function(e) {
        e = t.isStateClass(e) ? new e : e;
        var r = K(K(e, t.prototype));
        return e.$$state = function() {
          return r
        }, r.self = e, r.__stateObjectCache = {
          nameGlob: _.fromString(r.name)
        }, r
      }, t.prototype.is = function(t) {
        return this === t || this.self === t || this.fqn() === t
      }, t.prototype.fqn = function() {
        if (!(this.parent && this.parent instanceof this.constructor)) return this.name;
        var t = this.parent.fqn();
        return t ? t + "." + this.name : this.name
      }, t.prototype.root = function() {
        return this.parent && this.parent.root() || this
      }, t.prototype.parameters = function(t) {
        return ((t = it(t, {
          inherit: !0,
          matchingKeys: null
        })).inherit && this.parent && this.parent.parameters() || []).concat(dt(this.params)).filter(function(e) {
          return !t.matchingKeys || t.matchingKeys.hasOwnProperty(e.id)
        })
      }, t.prototype.parameter = function(t, e) {
        return void 0 === e && (e = {}), this.url && this.url.parameter(t, e) || lt(dt(this.params), s("id", t)) || e.inherit && this.parent && this.parent.parameter(t)
      }, t.prototype.toString = function() {
        return this.fqn()
      }, t.isStateClass = function(t) {
        return P(t) && !0 === t.__uiRouterState
      }, t.isState = function(t) {
        return x(t.__stateObjectCache)
      }, t
    }(),
    S = Object.prototype.toString,
    R = function(t) {
      return function(e) {
        return typeof e === t
      }
    },
    b = R("undefined"),
    E = f(b),
    T = function(t) {
      return null === t
    },
    C = h(T, b),
    P = R("function"),
    k = R("number"),
    O = R("string"),
    x = function(t) {
      return null !== t && "object" == typeof t
    },
    j = Array.isArray,
    I = function(t) {
      return "[object Date]" === S.call(t)
    },
    V = function(t) {
      return "[object RegExp]" === S.call(t)
    },
    A = $.isState;

  function H(t) {
    if (j(t) && t.length) {
      var e = t.slice(0, -1),
        r = t.slice(-1);
      return !(e.filter(f(O)).length || r.filter(f(P)).length)
    }
    return P(t)
  }
  var q = l(x, a(u("then"), P)),
    D = function(t) {
      return function() {
        throw new Error(t + "(): No coreservices implementation for UI-Router is loaded.")
      }
    },
    N = {
      $q: void 0,
      $injector: void 0
    },
    F = ("undefined" == typeof window ? {} : window).angular || {},
    U = F.fromJson || JSON.parse.bind(JSON),
    L = F.toJson || JSON.stringify.bind(JSON),
    M = F.copy || function(t, e) {
      e && Object.keys(e).forEach(function(t) {
        return delete e[t]
      });
      e || (e = {});
      return G(e, t)
    },
    B = F.forEach || function(t, e, r) {
      if (j(t)) return t.forEach(e, r);
      Object.keys(t).forEach(function(r) {
        return e(t[r], r)
      })
    },
    G = Object.assign || Ot,
    W = F.equals || xt;

  function z(t) {
    return t
  }

  function J() {}

  function Q(t, e, r, n, i) {
    void 0 === i && (i = !1);
    var o = function(e) {
      return t()[e].bind(r())
    };
    return (n = n || Object.keys(t())).reduce(function(t, r) {
      var n;
      return t[r] = i ? (n = r, function() {
        return e[n] = o(n), e[n].apply(null, arguments)
      }) : o(r), t
    }, e)
  }
  var K = function(t, e) {
      return G(Object.create(t), e)
    },
    Y = i(Z);

  function Z(t, e) {
    return -1 !== t.indexOf(e)
  }
  var X = i(tt);

  function tt(t, e) {
    var r = t.indexOf(e);
    return r >= 0 && t.splice(r, 1), t
  }
  var et = i(rt);

  function rt(t, e) {
    return t.push(e), e
  }
  var nt = function(t) {
    return t.slice().forEach(function(e) {
      "function" == typeof e && e(), X(t, e)
    })
  };

  function it(t) {
    for (var e = [], r = 1; r < arguments.length; r++) e[r - 1] = arguments[r];
    var n = e.concat({}).reverse(),
      i = G.apply(null, n);
    return G({}, i, ut(t || {}, Object.keys(i)))
  }
  var ot = function(t, e) {
    return G(t, e)
  };

  function at(t, e) {
    var r = [];
    for (var n in t.path) {
      if (t.path[n] !== e.path[n]) break;
      r.push(t.path[n])
    }
    return r
  }

  function ut(t, e) {
    var r = {};
    for (var n in t) - 1 !== e.indexOf(n) && (r[n] = t[n]);
    return r
  }

  function st(t, e) {
    return Object.keys(t).filter(f(Y(e))).reduce(function(e, r) {
      return e[r] = t[r], e
    }, {})
  }

  function ct(t, e) {
    return pt(t, u(e))
  }

  function ft(t, e) {
    var r = j(t),
      n = r ? [] : {},
      i = r ? function(t) {
        return n.push(t)
      } : function(t, e) {
        return n[e] = t
      };
    return B(t, function(t, r) {
      e(t, r) && i(t, r)
    }), n
  }

  function lt(t, e) {
    var r;
    return B(t, function(t, n) {
      r || e(t, n) && (r = t)
    }), r
  }
  var ht = pt;

  function pt(t, e) {
    var r = j(t) ? [] : {};
    return B(t, function(t, n) {
      return r[n] = e(t, n)
    }), r
  }
  var dt = function(t) {
      return Object.keys(t).map(function(e) {
        return t[e]
      })
    },
    vt = function(t, e) {
      return t && e
    },
    mt = function(t, e) {
      return t || e
    },
    yt = function(t, e) {
      return t.concat(e)
    },
    gt = function(t, e) {
      return j(e) ? t.concat(e.reduce(gt, [])) : wt(t, e)
    };

  function wt(t, e) {
    return t.push(e), t
  }
  var _t = function(t, e) {
      return Y(t, e) ? t : wt(t, e)
    },
    $t = function(t) {
      return t.reduce(yt, [])
    },
    St = function(t) {
      return t.reduce(gt, [])
    },
    Rt = Et,
    bt = Et;

  function Et(t, e) {
    return void 0 === e && (e = "assert failure"),
      function(r) {
        var n = t(r);
        if (!n) throw new Error(P(e) ? e(r) : e);
        return n
      }
  }
  var Tt = function(t) {
    return Object.keys(t).map(function(e) {
      return [e, t[e]]
    })
  };

  function Ct() {
    for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
    if (0 === t.length) return [];
    var r, n = t.reduce(function(t, e) {
        return Math.min(e.length, t)
      }, 9007199254740991),
      i = [];
    for (r = 0; r < n; r++) switch (t.length) {
      case 1:
        i.push([t[0][r]]);
        break;
      case 2:
        i.push([t[0][r], t[1][r]]);
        break;
      case 3:
        i.push([t[0][r], t[1][r], t[2][r]]);
        break;
      case 4:
        i.push([t[0][r], t[1][r], t[2][r], t[3][r]]);
        break;
      default:
        i.push(t.map(function(t) {
          return t[r]
        }))
    }
    return i
  }

  function Pt(t, e) {
    var r, n;
    if (j(e) && (r = e[0], n = e[1]), !O(r)) throw new Error("invalid parameters to applyPairs");
    return t[r] = n, t
  }

  function kt(t) {
    return t.length && t[t.length - 1] || void 0
  }

  function Ot(t) {
    for (var e = 1; e < arguments.length; e++) {
      var r = arguments[e];
      if (r)
        for (var n = Object.keys(r), i = 0; i < n.length; i++) t[n[i]] = r[n[i]]
    }
    return t
  }

  function xt(t, e) {
    if (t === e) return !0;
    if (null === t || null === e) return !1;
    if (t != t && e != e) return !0;
    var r = typeof t;
    if (r !== typeof e || "object" !== r) return !1;
    var n, i, o = [t, e];
    if (p(j)(o)) return n = t, i = e, n.length === i.length && Ct(n, i).reduce(function(t, e) {
      return t && xt(e[0], e[1])
    }, !0);
    if (p(I)(o)) return t.getTime() === e.getTime();
    if (p(V)(o)) return t.toString() === e.toString();
    if (p(P)(o)) return !0;
    if ([P, j, I, V].map(d).reduce(function(t, e) {
        return t || !!e(o)
      }, !1)) return !1;
    var a, u = {};
    for (a in t) {
      if (!xt(t[a], e[a])) return !1;
      u[a] = !0
    }
    for (a in e)
      if (!u[a]) return !1;
    return !0
  }
  var jt, It = function(t, e) {
      return void 0 === e && (e = y(!0)),
        function(r, n) {
          return e(r) && e(n) ? t(r) - t(n) : 0
        }
    },
    Vt = function() {
      for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
      return function(e, r) {
        return t.reduce(function(t, n) {
          return t || n(e, r)
        }, 0)
      }
    },
    At = function(t) {
      return t.catch(function(t) {
        return 0
      }) && t
    },
    Ht = function(t) {
      return At(N.$q.reject(t))
    },
    qt = function() {
      function t(t, e) {
        void 0 === t && (t = []), void 0 === e && (e = null), this._items = t, this._limit = e
      }
      return t.prototype.enqueue = function(t) {
        var e = this._items;
        return e.push(t), this._limit && e.length > this._limit && e.shift(), t
      }, t.prototype.dequeue = function() {
        if (this.size()) return this._items.splice(0, 1)[0]
      }, t.prototype.clear = function() {
        var t = this._items;
        return this._items = [], t
      }, t.prototype.size = function() {
        return this._items.length
      }, t.prototype.remove = function(t) {
        var e = this._items.indexOf(t);
        return e > -1 && this._items.splice(e, 1)[0]
      }, t.prototype.peekTail = function() {
        return this._items[this._items.length - 1]
      }, t.prototype.peekHead = function() {
        if (this.size()) return this._items[0]
      }, t
    }();
  (jt = t.RejectType || (t.RejectType = {}))[jt.SUPERSEDED = 2] = "SUPERSEDED", jt[jt.ABORTED = 3] = "ABORTED", jt[jt.INVALID = 4] = "INVALID", jt[jt.IGNORED = 5] = "IGNORED", jt[jt.ERROR = 6] = "ERROR";
  var Dt = 0,
    Nt = function() {
      function e(t, e, r) {
        this.$id = Dt++, this.type = t, this.message = e, this.detail = r
      }
      return e.prototype.toString = function() {
        var t, e = (t = this.detail) && t.toString !== Object.prototype.toString ? t.toString() : Pe(t);
        return "Transition Rejection($id: " + this.$id + " type: " + this.type + ", message: " + this.message + ", detail: " + e + ")"
      }, e.prototype.toPromise = function() {
        return G(Ht(this), {
          _transitionRejection: this
        })
      }, e.isRejectionPromise = function(t) {
        return t && "function" == typeof t.then && v(e)(t._transitionRejection)
      }, e.superseded = function(r, n) {
        var i = new e(t.RejectType.SUPERSEDED, "The transition has been superseded by a different transition", r);
        return n && n.redirected && (i.redirected = !0), i
      }, e.redirected = function(t) {
        return e.superseded(t, {
          redirected: !0
        })
      }, e.invalid = function(r) {
        return new e(t.RejectType.INVALID, "This transition is invalid", r)
      }, e.ignored = function(r) {
        return new e(t.RejectType.IGNORED, "The transition was ignored", r)
      }, e.aborted = function(r) {
        return new e(t.RejectType.ABORTED, "The transition has been aborted", r)
      }, e.errored = function(r) {
        return new e(t.RejectType.ERROR, "The transition errored", r)
      }, e.normalize = function(t) {
        return v(e)(t) ? t : e.errored(t)
      }, e
    }();

  function Ft(t) {
    if (!t) return "ui-view (defunct)";
    var e = t.creationContext ? t.creationContext.name || "(root)" : "(none)";
    return "[ui-view#" + t.id + " " + t.$type + ":" + t.fqn + " (" + t.name + "@" + e + ")]"
  }
  var Ut;

  function Lt(e) {
    return k(e) ? t.Category[e] : t.Category[t.Category[e]]
  }(Ut = t.Category || (t.Category = {}))[Ut.RESOLVE = 0] = "RESOLVE", Ut[Ut.TRANSITION = 1] = "TRANSITION", Ut[Ut.HOOK = 2] = "HOOK", Ut[Ut.UIVIEW = 3] = "UIVIEW", Ut[Ut.VIEWCONFIG = 4] = "VIEWCONFIG";
  var Mt, Bt, Gt = c("$id"),
    Wt = c("router.$id"),
    zt = function(t) {
      return "Transition #" + Gt(t) + "-" + Wt(t)
    },
    Jt = function() {
      function e() {
        this._enabled = {}, this.approximateDigests = 0
      }
      return e.prototype._set = function(e, r) {
        var n = this;
        r.length || (r = Object.keys(t.Category).map(function(t) {
          return parseInt(t, 10)
        }).filter(function(t) {
          return !isNaN(t)
        }).map(function(e) {
          return t.Category[e]
        })), r.map(Lt).forEach(function(t) {
          return n._enabled[t] = e
        })
      }, e.prototype.enable = function() {
        for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
        this._set(!0, t)
      }, e.prototype.disable = function() {
        for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
        this._set(!1, t)
      }, e.prototype.enabled = function(t) {
        return !!this._enabled[Lt(t)]
      }, e.prototype.traceTransitionStart = function(e) {
        this.enabled(t.Category.TRANSITION) && console.log(zt(e) + ": Started  -> " + Pe(e))
      }, e.prototype.traceTransitionIgnored = function(e) {
        this.enabled(t.Category.TRANSITION) && console.log(zt(e) + ": Ignored  <> " + Pe(e))
      }, e.prototype.traceHookInvocation = function(e, r, n) {
        if (this.enabled(t.Category.HOOK)) {
          var i = c("traceData.hookType")(n) || "internal",
            o = c("traceData.context.state.name")(n) || c("traceData.context")(n) || "unknown",
            a = be(e.registeredHook.callback);
          console.log(zt(r) + ":   Hook -> " + i + " context: " + o + ", " + $e(200, a))
        }
      }, e.prototype.traceHookResult = function(e, r, n) {
        this.enabled(t.Category.HOOK) && console.log(zt(r) + ":   <- Hook returned: " + $e(200, Pe(e)))
      }, e.prototype.traceResolvePath = function(e, r, n) {
        this.enabled(t.Category.RESOLVE) && console.log(zt(n) + ":         Resolving " + e + " (" + r + ")")
      }, e.prototype.traceResolvableResolved = function(e, r) {
        this.enabled(t.Category.RESOLVE) && console.log(zt(r) + ":               <- Resolved  " + e + " to: " + $e(200, Pe(e.data)))
      }, e.prototype.traceError = function(e, r) {
        this.enabled(t.Category.TRANSITION) && console.log(zt(r) + ": <- Rejected " + Pe(r) + ", reason: " + e)
      }, e.prototype.traceSuccess = function(e, r) {
        this.enabled(t.Category.TRANSITION) && console.log(zt(r) + ": <- Success  " + Pe(r) + ", final state: " + e.name)
      }, e.prototype.traceUIViewEvent = function(e, r, n) {
        void 0 === n && (n = ""), this.enabled(t.Category.UIVIEW) && console.log("ui-view: " + Se(30, e) + " " + Ft(r) + n)
      }, e.prototype.traceUIViewConfigUpdated = function(e, r) {
        this.enabled(t.Category.UIVIEW) && this.traceUIViewEvent("Updating", e, " with ViewConfig from context='" + r + "'")
      }, e.prototype.traceUIViewFill = function(e, r) {
        this.enabled(t.Category.UIVIEW) && this.traceUIViewEvent("Fill", e, " with: " + $e(200, r))
      }, e.prototype.traceViewSync = function(e) {
        if (this.enabled(t.Category.VIEWCONFIG)) {
          var r = e.map(function(t) {
            var e = t[0],
              r = t[1];
            return {
              "ui-view fqn": e.$type + ":" + e.fqn,
              "state: view name": r && r.viewDecl.$context.name + ": " + r.viewDecl.$name + " (" + r.viewDecl.$type + ")"
            }
          }).sort(function(t, e) {
            return t["ui-view fqn"].localeCompare(e["ui-view fqn"])
          });
          console.table(r)
        }
      }, e.prototype.traceViewServiceEvent = function(e, r) {
        var n, i, o;
        this.enabled(t.Category.VIEWCONFIG) && console.log("VIEWCONFIG: " + e + " " + (i = (n = r).viewDecl, o = i.$context.name || "(root)", "[View#" + n.$id + " from '" + o + "' state]: target ui-view: '" + i.$uiViewName + "@" + i.$uiViewContextAnchor + "'"))
      }, e.prototype.traceViewServiceUIViewEvent = function(e, r) {
        this.enabled(t.Category.VIEWCONFIG) && console.log("VIEWCONFIG: " + e + " " + Ft(r))
      }, e
    }(),
    Qt = new Jt;
  (Mt = t.TransitionHookPhase || (t.TransitionHookPhase = {}))[Mt.CREATE = 0] = "CREATE", Mt[Mt.BEFORE = 1] = "BEFORE", Mt[Mt.RUN = 2] = "RUN", Mt[Mt.SUCCESS = 3] = "SUCCESS", Mt[Mt.ERROR = 4] = "ERROR", (Bt = t.TransitionHookScope || (t.TransitionHookScope = {}))[Bt.TRANSITION = 0] = "TRANSITION", Bt[Bt.STATE = 1] = "STATE";
  var Kt = function() {
      function t(t, e, r, n) {
        void 0 === n && (n = {}), this._identifier = t, this._definition = e, this._options = n, this._params = r || {}
      }
      return t.prototype.name = function() {
        return this._definition && this._definition.name || this._identifier
      }, t.prototype.identifier = function() {
        return this._identifier
      }, t.prototype.params = function() {
        return this._params
      }, t.prototype.$state = function() {
        return this._definition
      }, t.prototype.state = function() {
        return this._definition && this._definition.self
      }, t.prototype.options = function() {
        return this._options
      }, t.prototype.exists = function() {
        return !(!this._definition || !this._definition.self)
      }, t.prototype.valid = function() {
        return !this.error()
      }, t.prototype.error = function() {
        var t = this.options().relative;
        if (!this._definition && t) {
          var e = t.name ? t.name : t;
          return "Could not resolve '" + this.name() + "' from state '" + e + "'"
        }
        return this._definition ? this._definition.self ? void 0 : "State '" + this.name() + "' has an invalid definition" : "No such state '" + this.name() + "'"
      }, t.prototype.toString = function() {
        return "'" + this.name() + "'" + L(this.params())
      }, t.isDef = function(t) {
        return t && t.state && (O(t.state) || O(t.state.name))
      }, t
    }(),
    Yt = {
      current: J,
      transition: null,
      traceData: {},
      bind: null
    },
    Zt = function() {
      function e(e, r, n, i) {
        var o = this;
        this.transition = e, this.stateContext = r, this.registeredHook = n, this.options = i, this.isSuperseded = function() {
          return o.type.hookPhase === t.TransitionHookPhase.RUN && !o.options.transition.isActive()
        }, this.options = it(i, Yt), this.type = n.eventType
      }
      return e.prototype.logError = function(t) {
        this.transition.router.stateService.defaultErrorHandler()(t)
      }, e.prototype.invokeHook = function() {
        var t = this,
          e = this.registeredHook;
        if (!e._deregistered) {
          var r = this.getNotCurrentRejection();
          if (r) return r;
          var n = this.options;
          Qt.traceHookInvocation(this, this.transition, n);
          var i = function(r) {
              return e.eventType.getErrorHandler(t)(r)
            },
            o = function(r) {
              return e.eventType.getResultHandler(t)(r)
            };
          try {
            var a = e.callback.call(n.bind, t.transition, t.stateContext);
            return !this.type.synchronous && q(a) ? a.catch(function(t) {
              return Nt.normalize(t).toPromise()
            }).then(o, i) : o(a)
          } catch (t) {
            return i(Nt.normalize(t))
          }
        }
      }, e.prototype.handleHookResult = function(t) {
        var e = this,
          r = this.getNotCurrentRejection();
        return r || (q(t) ? t.then(function(t) {
          return e.handleHookResult(t)
        }) : (Qt.traceHookResult(t, this.transition, this.options), !1 === t ? Nt.aborted("Hook aborted transition").toPromise() : v(Kt)(t) ? Nt.redirected(t).toPromise() : void 0))
      }, e.prototype.getNotCurrentRejection = function() {
        var t = this.transition.router;
        return t._disposed ? Nt.aborted("UIRouter instance #" + t.$id + " has been stopped (disposed)").toPromise() : this.transition._aborted ? Nt.aborted().toPromise() : this.isSuperseded() ? Nt.superseded(this.options.current()).toPromise() : void 0
      }, e.prototype.toString = function() {
        var t = this.options,
          e = this.registeredHook;
        return (c("traceData.hookType")(t) || "internal") + " context: " + (c("traceData.context.state.name")(t) || c("traceData.context")(t) || "unknown") + ", " + $e(200, Ee(e.callback))
      }, e.chain = function(t, e) {
        return t.reduce(function(t, e) {
          return t.then(function() {
            return e.invokeHook()
          })
        }, e || N.$q.when())
      }, e.invokeHooks = function(t, r) {
        for (var n = 0; n < t.length; n++) {
          var i = t[n].invokeHook();
          if (q(i)) {
            var o = t.slice(n + 1);
            return e.chain(o, i).then(r)
          }
        }
        return r()
      }, e.runAllHooks = function(t) {
        t.forEach(function(t) {
          return t.invokeHook()
        })
      }, e.HANDLE_RESULT = function(t) {
        return function(e) {
          return t.handleHookResult(e)
        }
      }, e.LOG_REJECTED_RESULT = function(t) {
        return function(e) {
          q(e) && e.catch(function(e) {
            return t.logError(Nt.normalize(e))
          })
        }
      }, e.LOG_ERROR = function(t) {
        return function(e) {
          return t.logError(e)
        }
      }, e.REJECT_ERROR = function(t) {
        return function(t) {
          return Ht(t)
        }
      }, e.THROW_ERROR = function(t) {
        return function(t) {
          throw t
        }
      }, e
    }();

  function Xt(t, e) {
    var r = O(e) ? [e] : e;
    return !!(P(r) ? r : function(t) {
      for (var e = r, n = 0; n < e.length; n++) {
        var i = new _(e[n]);
        if (i && i.matches(t.name) || !i && e[n] === t.name) return !0
      }
      return !1
    })(t)
  }
  var te = function() {
    function e(t, e, r, n, i) {
      void 0 === i && (i = {}), this.tranSvc = t, this.eventType = e, this.callback = r, this.matchCriteria = n, this.priority = i.priority || 0, this.bind = i.bind || null, this._deregistered = !1
    }
    return e.prototype._matchingNodes = function(t, e) {
      if (!0 === e) return t;
      var r = t.filter(function(t) {
        return Xt(t.state, e)
      });
      return r.length ? r : null
    }, e.prototype._getDefaultMatchCriteria = function() {
      return pt(this.tranSvc._pluginapi._getPathTypes(), function() {
        return !0
      })
    }, e.prototype._getMatchingNodes = function(e) {
      var r = this,
        n = G(this._getDefaultMatchCriteria(), this.matchCriteria);
      return dt(this.tranSvc._pluginapi._getPathTypes()).reduce(function(i, o) {
        var a = o.scope === t.TransitionHookScope.STATE,
          u = e[o.name] || [],
          s = a ? u : [kt(u)];
        return i[o.name] = r._matchingNodes(s, n[o.name]), i
      }, {})
    }, e.prototype.matches = function(t) {
      var e = this._getMatchingNodes(t);
      return dt(e).every(z) ? e : null
    }, e
  }();

  function ee(t, e, r) {
    var n = (t._registeredHooks = t._registeredHooks || {})[r.name] = [];

    function i(t, i, o) {
      void 0 === o && (o = {});
      var a = new te(e, r, i, t, o);
      return n.push(a),
        function() {
          a._deregistered = !0, X(n)(a)
        }
    }
    return t[r.name] = i, i
  }
  var re = function() {
    function e(t) {
      this.transition = t
    }
    return e.prototype.buildHooksForPhase = function(t) {
      var e = this;
      return this.transition.router.transitionService._pluginapi._getEvents(t).map(function(t) {
        return e.buildHooks(t)
      }).reduce(yt, []).filter(z)
    }, e.prototype.buildHooks = function(e) {
      var r = this.transition,
        n = r.treeChanges(),
        i = this.getMatchingHooks(e, n);
      if (!i) return [];
      var o = {
        transition: r,
        current: r.options().current
      };
      return i.map(function(i) {
        return i.matches(n)[e.criteriaMatchPath.name].map(function(n) {
          var a = G({
              bind: i.bind,
              traceData: {
                hookType: e.name,
                context: n
              }
            }, o),
            u = e.criteriaMatchPath.scope === t.TransitionHookScope.STATE ? n.state.self : null,
            s = new Zt(r, u, i, a);
          return {
            hook: i,
            node: n,
            transitionHook: s
          }
        })
      }).reduce(yt, []).sort(function(t) {
        void 0 === t && (t = !1);
        return function(e, r) {
          var n = t ? -1 : 1,
            i = (e.node.state.path.length - r.node.state.path.length) * n;
          return 0 !== i ? i : r.hook.priority - e.hook.priority
        }
      }(e.reverseSort)).map(function(t) {
        return t.transitionHook
      })
    }, e.prototype.getMatchingHooks = function(e, r) {
      var n = e.hookPhase === t.TransitionHookPhase.CREATE,
        i = this.transition.router.transitionService;
      return (n ? [i] : [this.transition, i]).map(function(t) {
        return t.getHooks(e.name)
      }).filter(Rt(j, "broken event named: " + e.name)).reduce(yt, []).filter(function(t) {
        return t.matches(r)
      })
    }, e
  }();
  var ne = function() {
    function t(t) {
      this.pattern = /.*/, this.inherit = !0, G(this, t)
    }
    return t.prototype.is = function(t, e) {
      return !0
    }, t.prototype.encode = function(t, e) {
      return t
    }, t.prototype.decode = function(t, e) {
      return t
    }, t.prototype.equals = function(t, e) {
      return t == e
    }, t.prototype.$subPattern = function() {
      var t = this.pattern.toString();
      return t.substr(1, t.length - 2)
    }, t.prototype.toString = function() {
      return "{ParamType:" + this.name + "}"
    }, t.prototype.$normalize = function(t) {
      return this.is(t) ? t : this.decode(t)
    }, t.prototype.$asArray = function(t, e) {
      if (!t) return this;
      if ("auto" === t && !e) throw new Error("'auto' array mode is for query parameters only");
      return new function(t, e) {
        var r = this;

        function n(t) {
          return j(t) ? t : E(t) ? [t] : []
        }

        function i(t, r) {
          return function(i) {
            if (j(i) && 0 === i.length) return i;
            var o = n(i),
              a = pt(o, t);
            return !0 === r ? 0 === ft(a, function(t) {
              return !t
            }).length : function(t) {
              switch (t.length) {
                case 0:
                  return;
                case 1:
                  return "auto" === e ? t[0] : t;
                default:
                  return t
              }
            }(a)
          }
        }

        function o(t) {
          return function(e, r) {
            var i = n(e),
              o = n(r);
            if (i.length !== o.length) return !1;
            for (var a = 0; a < i.length; a++)
              if (!t(i[a], o[a])) return !1;
            return !0
          }
        }["encode", "decode", "equals", "$normalize"].forEach(function(e) {
          var n = t[e].bind(t),
            a = "equals" === e ? o : i;
          r[e] = a(n)
        }), G(this, {
          dynamic: t.dynamic,
          name: t.name,
          pattern: t.pattern,
          inherit: t.inherit,
          is: i(t.is.bind(t), !0),
          $arrayMode: e
        })
      }(this, t)
    }, t
  }();
  var ie, oe = Object.prototype.hasOwnProperty,
    ae = function(t) {
      return 0 === ["value", "type", "squash", "array", "dynamic"].filter(oe.bind(t || {})).length
    };
  (ie = t.DefType || (t.DefType = {}))[ie.PATH = 0] = "PATH", ie[ie.SEARCH = 1] = "SEARCH", ie[ie.CONFIG = 2] = "CONFIG";
  var ue = function() {
      function e(e, r, n, i, o) {
        r = function(e, r, n, i, o) {
          if (e.type && r && "string" !== r.name) throw new Error("Param '" + i + "' has two type configurations.");
          if (e.type && r && "string" === r.name && o.type(e.type)) return o.type(e.type);
          if (r) return r;
          if (!e.type) {
            var a = n === t.DefType.CONFIG ? "any" : n === t.DefType.PATH ? "path" : n === t.DefType.SEARCH ? "query" : "string";
            return o.type(a)
          }
          return e.type instanceof ne ? e.type : o.type(e.type)
        }(n = function(t) {
          function e() {
            return t.value
          }
          return t = ae(t) && {
            value: t
          } || t, e.__cacheable = !0, G(t, {
            $$fn: H(t.value) ? t.value : e
          })
        }(n), r, i, e, o.paramTypes);
        var a, s, c = (a = {
          array: i === t.DefType.SEARCH && "auto"
        }, s = e.match(/\[\]$/) ? {
          array: !0
        } : {}, G(a, s, n).array);
        r = c ? r.$asArray(c, i === t.DefType.SEARCH) : r;
        var f, l, h, p, d, v, m, y = void 0 !== n.value || i === t.DefType.SEARCH,
          g = E(n.dynamic) ? !!n.dynamic : !!r.dynamic,
          w = E(n.raw) ? !!n.raw : !!r.raw,
          _ = function(t, e, r) {
            var n = t.squash;
            if (!e || !1 === n) return !1;
            if (!E(n) || null == n) return r;
            if (!0 === n || O(n)) return n;
            throw new Error("Invalid squash policy: '" + n + "'. Valid policies: false, true, or arbitrary string")
          }(n, y, o.defaultSquashPolicy()),
          $ = (f = n, l = c, p = _, m = [{
            from: "",
            to: (h = y) || l ? void 0 : ""
          }, {
            from: null,
            to: h || l ? void 0 : ""
          }], d = j(f.replace) ? f.replace : [], O(p) && d.push({
            from: p,
            to: void 0
          }), v = pt(d, u("from")), ft(m, function(t) {
            return -1 === v.indexOf(t.from)
          }).concat(d)),
          S = E(n.inherit) ? !!n.inherit : !!r.inherit;
        G(this, {
          id: e,
          type: r,
          location: i,
          isOptional: y,
          dynamic: g,
          raw: w,
          squash: _,
          replace: $,
          inherit: S,
          array: c,
          config: n
        })
      }
      return e.prototype.isDefaultValue = function(t) {
        return this.isOptional && this.type.equals(this.value(), t)
      }, e.prototype.value = function(t) {
        var e = this;
        return t = function(t) {
          for (var r = 0, n = e.replace; r < n.length; r++) {
            var i = n[r];
            if (i.from === t) return i.to
          }
          return t
        }(t), b(t) ? function() {
          if (e._defaultValueCache) return e._defaultValueCache.defaultValue;
          if (!N.$injector) throw new Error("Injectable functions cannot be called at configuration time");
          var t = N.$injector.invoke(e.config.$$fn);
          if (null !== t && void 0 !== t && !e.type.is(t)) throw new Error("Default value (" + t + ") for parameter '" + e.id + "' is not an instance of ParamType (" + e.type.name + ")");
          return e.config.$$fn.__cacheable && (e._defaultValueCache = {
            defaultValue: t
          }), t
        }() : this.type.$normalize(t)
      }, e.prototype.isSearch = function() {
        return this.location === t.DefType.SEARCH
      }, e.prototype.validates = function(t) {
        if ((b(t) || null === t) && this.isOptional) return !0;
        var e = this.type.$normalize(t);
        if (!this.type.is(e)) return !1;
        var r = this.type.encode(e);
        return !(O(r) && !this.type.pattern.exec(r))
      }, e.prototype.toString = function() {
        return "{Param:" + this.id + " " + this.type + " squash: '" + this.squash + "' optional: " + this.isOptional + "}"
      }, e.values = function(t, e) {
        void 0 === e && (e = {});
        for (var r = {}, n = 0, i = t; n < i.length; n++) {
          var o = i[n];
          r[o.id] = o.value(e[o.id])
        }
        return r
      }, e.changed = function(t, e, r) {
        return void 0 === e && (e = {}), void 0 === r && (r = {}), t.filter(function(t) {
          return !t.type.equals(e[t.id], r[t.id])
        })
      }, e.equals = function(t, r, n) {
        return void 0 === r && (r = {}), void 0 === n && (n = {}), 0 === e.changed(t, r, n).length
      }, e.validates = function(t, e) {
        return void 0 === e && (e = {}), t.map(function(t) {
          return t.validates(e[t.id])
        }).reduce(vt, !0)
      }, e
    }(),
    se = function() {
      function t(e) {
        if (e instanceof t) {
          var r = e;
          this.state = r.state, this.paramSchema = r.paramSchema.slice(), this.paramValues = G({}, r.paramValues), this.resolvables = r.resolvables.slice(), this.views = r.views && r.views.slice()
        } else {
          var n = e;
          this.state = n, this.paramSchema = n.parameters({
            inherit: !1
          }), this.paramValues = {}, this.resolvables = n.resolvables.map(function(t) {
            return t.clone()
          })
        }
      }
      return t.prototype.applyRawParams = function(t) {
        return this.paramValues = this.paramSchema.reduce(function(e, r) {
          return Pt(e, [(n = r).id, n.value(t[n.id])]);
          var n
        }, {}), this
      }, t.prototype.parameter = function(t) {
        return lt(this.paramSchema, s("id", t))
      }, t.prototype.equals = function(t, e) {
        var r = this.diff(t, e);
        return r && 0 === r.length
      }, t.prototype.diff = function(t, e) {
        if (this.state !== t.state) return !1;
        var r = e ? e(this) : this.paramSchema;
        return ue.changed(r, this.paramValues, t.paramValues)
      }, t.clone = function(e) {
        return new t(e)
      }, t
    }(),
    ce = function() {
      function t() {}
      return t.makeTargetState = function(t) {
        var e = kt(t).state;
        return new Kt(e, e, t.map(u("paramValues")).reduce(ot, {}))
      }, t.buildPath = function(t) {
        var e = t.params();
        return t.$state().path.map(function(t) {
          return new se(t).applyRawParams(e)
        })
      }, t.buildToPath = function(e, r) {
        var n = t.buildPath(r);
        return r.options().inherit ? t.inheritParams(e, n, Object.keys(r.params())) : n
      }, t.applyViewConfigs = function(e, r, n) {
        r.filter(function(t) {
          return Y(n, t.state)
        }).forEach(function(n) {
          var i = dt(n.state.views || {}),
            o = t.subPath(r, function(t) {
              return t === n
            }),
            a = i.map(function(t) {
              return e.createViewConfig(o, t)
            });
          n.views = a.reduce(yt, [])
        })
      }, t.inheritParams = function(t, e, r) {
        void 0 === r && (r = []);
        var n = t.map(function(t) {
          return t.paramSchema
        }).reduce(yt, []).filter(function(t) {
          return !t.inherit
        }).map(u("id"));
        return e.map(function(e) {
          var i = G({}, e && e.paramValues),
            o = ut(i, r);
          i = st(i, r);
          var a, u, c, f = st((a = t, u = e.state, c = lt(a, s("state", u)), G({}, c && c.paramValues) || {}), n),
            l = G(i, f, o);
          return new se(e.state).applyRawParams(l)
        })
      }, t.treeChanges = function(e, r, n) {
        for (var i, o, a, u, s, c, f = 0, l = Math.min(e.length, r.length); f < l && e[f].state !== n && (i = e[f], o = r[f], i.equals(o, t.nonDynamicParams));) f++;
        u = (a = e).slice(0, f), s = a.slice(f);
        var h = u.map(function(t, e) {
          var n = se.clone(t);
          return n.paramValues = r[e].paramValues, n
        });
        return c = r.slice(f), {
          from: a,
          to: h.concat(c),
          retained: u,
          exiting: s,
          entering: c
        }
      }, t.matching = function(t, e, r) {
        var n = !1;
        return Ct(t, e).reduce(function(t, e) {
          var i = e[0],
            o = e[1];
          return (n = n || !i.equals(o, r)) ? t : t.concat(i)
        }, [])
      }, t.equals = function(e, r, n) {
        return e.length === r.length && t.matching(e, r, n).length === e.length
      }, t.subPath = function(t, e) {
        var r = lt(t, e),
          n = t.indexOf(r);
        return -1 === n ? void 0 : t.slice(0, n + 1)
      }, t.nonDynamicParams = function(t) {
        return t.state.parameters({
          inherit: !1
        }).filter(function(t) {
          return !t.dynamic
        })
      }, t.paramValues = function(t) {
        return t.reduce(function(t, e) {
          return G(t, e.paramValues)
        }, {})
      }, t
    }(),
    fe = {
      when: "LAZY",
      async: "WAIT"
    },
    le = function() {
      function t(e, r, n, i, o) {
        if (this.resolved = !1, this.promise = void 0, e instanceof t) G(this, e);
        else if (P(r)) {
          if (C(e)) throw new Error("new Resolvable(): token argument is required");
          if (!P(r)) throw new Error("new Resolvable(): resolveFn argument must be a function");
          this.token = e, this.policy = i, this.resolveFn = r, this.deps = n || [], this.data = o, this.resolved = void 0 !== o, this.promise = this.resolved ? N.$q.when(this.data) : void 0
        } else if (x(e) && e.token && P(e.resolveFn)) {
          var a = e;
          return new t(a.token, a.resolveFn, a.deps, a.policy, a.data)
        }
      }
      return t.prototype.getPolicy = function(t) {
        var e = this.policy || {},
          r = t && t.resolvePolicy || {};
        return {
          when: e.when || r.when || fe.when,
          async: e.async || r.async || fe.async
        }
      }, t.prototype.resolve = function(t, e) {
        var r = this,
          n = N.$q,
          i = t.findNode(this),
          o = i && i.state,
          a = "RXWAIT" === this.getPolicy(o).async ? function(t) {
            var e = t.cache(1);
            return e.take(1).toPromise().then(function() {
              return e
            })
          } : z;
        return this.promise = n.when().then(function() {
          return n.all(t.getDependencies(r).map(function(r) {
            return r.get(t, e)
          }))
        }).then(function(t) {
          return r.resolveFn.apply(null, t)
        }).then(a).then(function(t) {
          return r.data = t, r.resolved = !0, Qt.traceResolvableResolved(r, e), r.data
        })
      }, t.prototype.get = function(t, e) {
        return this.promise || this.resolve(t, e)
      }, t.prototype.toString = function() {
        return "Resolvable(token: " + Pe(this.token) + ", requires: [" + this.deps.map(Pe) + "])"
      }, t.prototype.clone = function() {
        return new t(this)
      }, t.fromData = function(e, r) {
        return new t(e, function() {
          return r
        }, null, null, r)
      }, t
    }(),
    he = {
      when: {
        LAZY: "LAZY",
        EAGER: "EAGER"
      },
      async: {
        WAIT: "WAIT",
        NOWAIT: "NOWAIT",
        RXWAIT: "RXWAIT"
      }
    },
    pe = he.when,
    de = [pe.EAGER, pe.LAZY],
    ve = [pe.EAGER],
    me = "Native Injector",
    ye = function() {
      function t(t) {
        this._path = t
      }
      return t.prototype.getTokens = function() {
        return this._path.reduce(function(t, e) {
          return t.concat(e.resolvables.map(function(t) {
            return t.token
          }))
        }, []).reduce(_t, [])
      }, t.prototype.getResolvable = function(t) {
        return kt(this._path.map(function(t) {
          return t.resolvables
        }).reduce(yt, []).filter(function(e) {
          return e.token === t
        }))
      }, t.prototype.getPolicy = function(t) {
        var e = this.findNode(t);
        return t.getPolicy(e.state)
      }, t.prototype.subContext = function(e) {
        return new t(ce.subPath(this._path, function(t) {
          return t.state === e
        }))
      }, t.prototype.addResolvables = function(t, e) {
        var r = lt(this._path, s("state", e)),
          n = t.map(function(t) {
            return t.token
          });
        r.resolvables = r.resolvables.filter(function(t) {
          return -1 === n.indexOf(t.token)
        }).concat(t)
      }, t.prototype.resolvePath = function(t, e) {
        var r = this;
        void 0 === t && (t = "LAZY");
        var n = (Y(de, t) ? t : "LAZY") === he.when.EAGER ? ve : de;
        Qt.traceResolvePath(this._path, t, e);
        var i = function(t, e) {
            return function(n) {
              return Y(t, r.getPolicy(n)[e])
            }
          },
          o = this._path.reduce(function(t, o) {
            var a = o.resolvables.filter(i(n, "when")),
              u = a.filter(i(["NOWAIT"], "async")),
              s = a.filter(f(i(["NOWAIT"], "async"))),
              c = r.subContext(o.state),
              l = function(t) {
                return t.get(c, e).then(function(e) {
                  return {
                    token: t.token,
                    value: e
                  }
                })
              };
            return u.forEach(l), t.concat(s.map(l))
          }, []);
        return N.$q.all(o)
      }, t.prototype.injector = function() {
        return this._injector || (this._injector = new ge(this))
      }, t.prototype.findNode = function(t) {
        return lt(this._path, function(e) {
          return Y(e.resolvables, t)
        })
      }, t.prototype.getDependencies = function(t) {
        var e = this,
          r = this.findNode(t),
          n = (ce.subPath(this._path, function(t) {
            return t === r
          }) || this._path).reduce(function(t, e) {
            return t.concat(e.resolvables)
          }, []).filter(function(e) {
            return e !== t
          });
        return t.deps.map(function(t) {
          var r = n.filter(function(e) {
            return e.token === t
          });
          if (r.length) return kt(r);
          var i = e.injector().getNative(t);
          if (!i) throw new Error("Could not find Dependency Injection token: " + Pe(t));
          return new le(t, function() {
            return i
          }, [], i)
        })
      }, t
    }(),
    ge = function() {
      function t(t) {
        this.context = t, this.native = this.get(me) || N.$injector
      }
      return t.prototype.get = function(t) {
        var e = this.context.getResolvable(t);
        if (e) {
          if ("NOWAIT" === this.context.getPolicy(e).async) return e.get(this.context);
          if (!e.resolved) throw new Error("Resolvable async .get() not complete:" + Pe(e.token));
          return e.data
        }
        return this.native && this.native.get(t)
      }, t.prototype.getAsync = function(t) {
        var e = this.context.getResolvable(t);
        return e ? e.get(this.context) : N.$q.when(this.native.get(t))
      }, t.prototype.getNative = function(t) {
        return this.native && this.native.get(t)
      }, t
    }(),
    we = u("self"),
    _e = function() {
      function e(e, r, n) {
        var i = this;
        if (this._deferred = N.$q.defer(), this.promise = this._deferred.promise, this._registeredHooks = {}, this._hookBuilder = new re(this), this.isActive = function() {
            return i.router.globals.transition === i
          }, this.router = n, this._targetState = r, !r.valid()) throw new Error(r.error());
        this._options = G({
          current: y(this)
        }, r.options()), this.$id = n.transitionService._transitionCount++;
        var o = ce.buildToPath(e, r);
        this._treeChanges = ce.treeChanges(e, o, this._options.reloadState), this.createTransitionHookRegFns();
        var a = this._hookBuilder.buildHooksForPhase(t.TransitionHookPhase.CREATE);
        Zt.invokeHooks(a, function() {
          return null
        }), this.applyViewConfigs(n)
      }
      return e.prototype.onBefore = function(t, e, r) {}, e.prototype.onStart = function(t, e, r) {}, e.prototype.onExit = function(t, e, r) {}, e.prototype.onRetain = function(t, e, r) {}, e.prototype.onEnter = function(t, e, r) {}, e.prototype.onFinish = function(t, e, r) {}, e.prototype.onSuccess = function(t, e, r) {}, e.prototype.onError = function(t, e, r) {}, e.prototype.createTransitionHookRegFns = function() {
        var e = this;
        this.router.transitionService._pluginapi._getEvents().filter(function(e) {
          return e.hookPhase !== t.TransitionHookPhase.CREATE
        }).forEach(function(t) {
          return ee(e, e.router.transitionService, t)
        })
      }, e.prototype.getHooks = function(t) {
        return this._registeredHooks[t]
      }, e.prototype.applyViewConfigs = function(t) {
        var e = this._treeChanges.entering.map(function(t) {
          return t.state
        });
        ce.applyViewConfigs(t.transitionService.$view, this._treeChanges.to, e)
      }, e.prototype.$from = function() {
        return kt(this._treeChanges.from).state
      }, e.prototype.$to = function() {
        return kt(this._treeChanges.to).state
      }, e.prototype.from = function() {
        return this.$from().self
      }, e.prototype.to = function() {
        return this.$to().self
      }, e.prototype.targetState = function() {
        return this._targetState
      }, e.prototype.is = function(t) {
        return t instanceof e ? this.is({
          to: t.$to().name,
          from: t.$from().name
        }) : !(t.to && !Xt(this.$to(), t.to) || t.from && !Xt(this.$from(), t.from))
      }, e.prototype.params = function(t) {
        return void 0 === t && (t = "to"), Object.freeze(this._treeChanges[t].map(u("paramValues")).reduce(ot, {}))
      }, e.prototype.injector = function(t, e) {
        void 0 === e && (e = "to");
        var r = this._treeChanges[e];
        return t && (r = ce.subPath(r, function(e) {
          return e.state === t || e.state.name === t
        })), new ye(r).injector()
      }, e.prototype.getResolveTokens = function(t) {
        return void 0 === t && (t = "to"), new ye(this._treeChanges[t]).getTokens()
      }, e.prototype.addResolvable = function(t, e) {
        void 0 === e && (e = ""), t = v(le)(t) ? t : new le(t);
        var r = "string" == typeof e ? e : e.name,
          n = this._treeChanges.to,
          i = lt(n, function(t) {
            return t.state.name === r
          });
        new ye(n).addResolvables([t], i.state)
      }, e.prototype.redirectedFrom = function() {
        return this._options.redirectedFrom || null
      }, e.prototype.originalTransition = function() {
        var t = this.redirectedFrom();
        return t && t.originalTransition() || this
      }, e.prototype.options = function() {
        return this._options
      }, e.prototype.entering = function() {
        return pt(this._treeChanges.entering, u("state")).map(we)
      }, e.prototype.exiting = function() {
        return pt(this._treeChanges.exiting, u("state")).map(we).reverse()
      }, e.prototype.retained = function() {
        return pt(this._treeChanges.retained, u("state")).map(we)
      }, e.prototype.views = function(t, e) {
        void 0 === t && (t = "entering");
        var r = this._treeChanges[t];
        return (r = e ? r.filter(s("state", e)) : r).map(u("views")).filter(z).reduce(yt, [])
      }, e.prototype.treeChanges = function(t) {
        return t ? this._treeChanges[t] : this._treeChanges
      }, e.prototype.redirect = function(t) {
        for (var e = 1, r = this; null != (r = r.redirectedFrom());)
          if (++e > 20) throw new Error("Too many consecutive Transition redirects (20+)");
        var n = {
          redirectedFrom: this,
          source: "redirect"
        };
        "url" === this.options().source && !1 !== t.options().location && (n.location = "replace");
        var i = G({}, this.options(), t.options(), n);
        t = new Kt(t.identifier(), t.$state(), t.params(), i);
        var o, a = this.router.transitionService.create(this._treeChanges.from, t),
          u = this._treeChanges.entering,
          s = a._treeChanges.entering;
        return ce.matching(s, u, ce.nonDynamicParams).filter(f((o = t.options().reloadState, function(t) {
          return o && t.state.includes[o.name]
        }))).forEach(function(t, e) {
          t.resolvables = u[e].resolvables
        }), a
      }, e.prototype._changedParams = function() {
        var t = this._treeChanges;
        if (!this._options.reload && (!t.exiting.length && !t.entering.length && t.to.length === t.from.length && !Ct(t.to, t.from).map(function(t) {
            return t[0].state !== t[1].state
          }).reduce(mt, !1))) {
          var e = t.to.map(function(t) {
              return t.paramSchema
            }),
            r = [t.to, t.from].map(function(t) {
              return t.map(function(t) {
                return t.paramValues
              })
            });
          return Ct(e, r[0], r[1]).map(function(t) {
            var e = t[0],
              r = t[1],
              n = t[2];
            return ue.changed(e, r, n)
          }).reduce(yt, [])
        }
      }, e.prototype.dynamic = function() {
        var t = this._changedParams();
        return !!t && t.map(function(t) {
          return t.dynamic
        }).reduce(mt, !1)
      }, e.prototype.ignored = function() {
        return !!this._ignoredReason()
      }, e.prototype._ignoredReason = function() {
        var t = this.router.globals.transition,
          e = this._options.reloadState,
          r = function(t, r) {
            if (t.length !== r.length) return !1;
            var n = ce.matching(t, r);
            return t.length === n.filter(function(t) {
              return !e || !t.state.includes[e.name]
            }).length
          },
          n = this.treeChanges(),
          i = t && t.treeChanges();
        return i && r(i.to, n.to) && r(i.exiting, n.exiting) ? "SameAsPending" : 0 === n.exiting.length && 0 === n.entering.length && r(n.from, n.to) ? "SameAsCurrent" : void 0
      }, e.prototype.run = function() {
        var e = this,
          r = Zt.runAllHooks,
          n = function(t) {
            return e._hookBuilder.buildHooksForPhase(t)
          },
          i = n(t.TransitionHookPhase.BEFORE);
        return Zt.invokeHooks(i, function() {
          var t = e.router.globals;
          return t.lastStartedTransitionId = e.$id, t.transition = e, t.transitionHistory.enqueue(e), Qt.traceTransitionStart(e), N.$q.when(void 0)
        }).then(function() {
          var e = n(t.TransitionHookPhase.RUN);
          return Zt.invokeHooks(e, function() {
            return N.$q.when(void 0)
          })
        }).then(function() {
          Qt.traceSuccess(e.$to(), e), e.success = !0, e._deferred.resolve(e.to()), r(n(t.TransitionHookPhase.SUCCESS))
        }, function(i) {
          Qt.traceError(i, e), e.success = !1, e._deferred.reject(i), e._error = i, r(n(t.TransitionHookPhase.ERROR))
        }), this.promise
      }, e.prototype.valid = function() {
        return !this.error() || void 0 !== this.success
      }, e.prototype.abort = function() {
        b(this.success) && (this._aborted = !0)
      }, e.prototype.error = function() {
        var t = this.$to();
        if (t.self.abstract) return "Cannot transition to abstract state '" + t.name + "'";
        var e = t.parameters(),
          r = this.params(),
          n = e.filter(function(t) {
            return !t.validates(r[t.id])
          });
        return n.length ? "Param values not valid for state '" + t.name + "'. Invalid params: [ " + n.map(function(t) {
          return t.id
        }).join(", ") + " ]" : !1 === this.success ? this._error : void 0
      }, e.prototype.toString = function() {
        var t = this.from(),
          e = this.to(),
          r = function(t) {
            return null !== t["#"] && void 0 !== t["#"] ? t : st(t, ["#"])
          };
        return "Transition#" + this.$id + "( '" + (x(t) ? t.name : t) + "'" + L(r(this._treeChanges.from.map(u("paramValues")).reduce(ot, {}))) + " -> " + (this.valid() ? "" : "(X) ") + "'" + (x(e) ? e.name : e) + "'" + L(r(this.params())) + " )"
      }, e.diToken = e, e
    }();

  function $e(t, e) {
    return e.length <= t ? e : e.substr(0, t - 3) + "..."
  }

  function Se(t, e) {
    for (; e.length < t;) e += " ";
    return e
  }

  function Re(t) {
    return t.replace(/^([A-Z])/, function(t) {
      return t.toLowerCase()
    }).replace(/([A-Z])/g, function(t) {
      return "-" + t.toLowerCase()
    })
  }

  function be(t) {
    var e = Ee(t),
      r = e.match(/^(function [^ ]+\([^)]*\))/),
      n = r ? r[1] : e,
      i = t.name || "";
    return i && n.match(/function \(/) ? "function " + i + n.substr(9) : n
  }

  function Ee(t) {
    var e = j(t) ? t.slice(-1)[0] : t;
    return e && e.toString() || "undefined"
  }
  var Te = null,
    Ce = function(t) {
      var e = Nt.isRejectionPromise;
      return (Te = Te || w([
        [f(E), y("undefined")],
        [T, y("null")],
        [q, y("[Promise]")],
        [e, function(t) {
          return t._transitionRejection.toString()
        }],
        [v(Nt), g("toString")],
        [v(_e), g("toString")],
        [v(le), g("toString")],
        [H, be],
        [y(!0), z]
      ]))(t)
    };

  function Pe(t) {
    var e = [];
    return JSON.stringify(t, function(t, r) {
      return function(t) {
        if (x(t)) {
          if (-1 !== e.indexOf(t)) return "[circular ref]";
          e.push(t)
        }
        return Ce(t)
      }(r)
    }).replace(/\\"/g, '"')
  }
  var ke = function(t) {
    return function(e) {
      if (!e) return ["", ""];
      var r = e.indexOf(t);
      return -1 === r ? [e, ""] : [e.substr(0, r), e.substr(r + 1)]
    }
  };

  function Oe(t) {
    var e = new RegExp("(" + t + ")", "g");
    return function(t) {
      return t.split(e).filter(z)
    }
  }

  function xe(t, e) {
    return O(kt(t)) && O(e) ? t.slice(0, -1).concat(kt(t) + e) : wt(t, e)
  }
  var je, Ie = function() {
    function t() {
      this.enqueue = !0, this.typeQueue = [], this.defaultTypes = ut(t.prototype, ["hash", "string", "query", "path", "int", "bool", "date", "json", "any"]);
      this.types = K(pt(this.defaultTypes, function(t, e) {
        return new ne(G({
          name: e
        }, t))
      }), {})
    }
    return t.prototype.dispose = function() {
      this.types = {}
    }, t.prototype.type = function(t, e, r) {
      if (!E(e)) return this.types[t];
      if (this.types.hasOwnProperty(t)) throw new Error("A type named '" + t + "' has already been defined.");
      return this.types[t] = new ne(G({
        name: t
      }, e)), r && (this.typeQueue.push({
        name: t,
        def: r
      }), this.enqueue || this._flushTypeQueue()), this
    }, t.prototype._flushTypeQueue = function() {
      for (; this.typeQueue.length;) {
        var t = this.typeQueue.shift();
        if (t.pattern) throw new Error("You cannot override a type's .pattern at runtime.");
        G(this.types[t.name], N.$injector.invoke(t.def))
      }
    }, t
  }();
  je = function(t) {
    var e = function(t) {
        return null != t ? t.toString() : t
      },
      r = {
        encode: e,
        decode: e,
        is: v(String),
        pattern: /.*/,
        equals: function(t, e) {
          return t == e
        }
      };
    return G({}, r, t)
  }, G(Ie.prototype, {
    string: je({}),
    path: je({
      pattern: /[^/]*/
    }),
    query: je({}),
    hash: je({
      inherit: !1
    }),
    int: je({
      decode: function(t) {
        return parseInt(t, 10)
      },
      is: function(t) {
        return !C(t) && this.decode(t.toString()) === t
      },
      pattern: /-?\d+/
    }),
    bool: je({
      encode: function(t) {
        return t ? 1 : 0
      },
      decode: function(t) {
        return 0 !== parseInt(t, 10)
      },
      is: v(Boolean),
      pattern: /0|1/
    }),
    date: je({
      encode: function(t) {
        return this.is(t) ? [t.getFullYear(), ("0" + (t.getMonth() + 1)).slice(-2), ("0" + t.getDate()).slice(-2)].join("-") : void 0
      },
      decode: function(t) {
        if (this.is(t)) return t;
        var e = this.capture.exec(t);
        return e ? new Date(e[1], e[2] - 1, e[3]) : void 0
      },
      is: function(t) {
        return t instanceof Date && !isNaN(t.valueOf())
      },
      equals: function(t, e) {
        return ["getFullYear", "getMonth", "getDate"].reduce(function(r, n) {
          return r && t[n]() === e[n]()
        }, !0)
      },
      pattern: /[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,
      capture: /([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/
    }),
    json: je({
      encode: L,
      decode: U,
      is: v(Object),
      equals: W,
      pattern: /[^/]*/
    }),
    any: je({
      encode: z,
      decode: z,
      is: function() {
        return !0
      },
      equals: W
    })
  });
  var Ve = function() {
    function t(t) {
      void 0 === t && (t = {}), G(this, t)
    }
    return t.prototype.$inherit = function(t, e, r) {
      var n, i = at(e, r),
        o = {},
        a = [];
      for (var u in i)
        if (i[u] && i[u].params && (n = Object.keys(i[u].params)).length)
          for (var s in n) a.indexOf(n[s]) >= 0 || (a.push(n[s]), o[n[s]] = this[n[s]]);
      return G({}, o, t)
    }, t
  }();

  function Ae(t) {
    return t.name
  }

  function He(t) {
    return t.self.$$state = function() {
      return t
    }, t.self
  }

  function qe(t) {
    return t.parent && t.parent.data && (t.data = t.self.data = K(t.parent.data, t.data)), t.data
  }
  var De = function(t, e) {
      return function(r) {
        var n = r;
        n && n.url && n.name && n.name.match(/\.\*\*$/) && (n.url += "{remainder:any}");
        var i = function(t) {
            if (!O(t)) return !1;
            var e = "^" === t.charAt(0);
            return {
              val: e ? t.substring(1) : t,
              root: e
            }
          }(n.url),
          o = r.parent,
          a = i ? t.compile(i.val, {
            params: r.params || {},
            paramMap: function(t, e) {
              return !1 === n.reloadOnSearch && e && (t = G(t || {}, {
                dynamic: !0
              })), t
            }
          }) : n.url;
        if (!a) return null;
        if (!t.isMatcher(a)) throw new Error("Invalid url '" + a + "' in state '" + r + "'");
        return i && i.root ? a : (o && o.navigable || e()).url.append(a)
      }
    },
    Ne = function(t) {
      return function(e) {
        return !t(e) && e.url ? e : e.parent ? e.parent.navigable : null
      }
    },
    Fe = function(t) {
      return function(e) {
        var r = e.url && e.url.parameters({
            inherit: !1
          }) || [],
          n = dt(ht(st(e.params || {}, r.map(u("id"))), function(e, r) {
            return t.fromConfig(r, null, e)
          }));
        return r.concat(n).map(function(t) {
          return [t.id, t]
        }).reduce(Pt, {})
      }
    };

  function Ue(t) {
    return t.parent ? t.parent.path.concat(t) : [t]
  }

  function Le(t) {
    var e = t.parent ? G({}, t.parent.includes) : {};
    return e[t.name] = !0, e
  }

  function Me(t) {
    var e, r, n = function(t) {
        return t.provide || t.token
      },
      i = w([
        [u("resolveFn"), function(t) {
          return new le(n(t), t.resolveFn, t.deps, t.policy)
        }],
        [u("useFactory"), function(t) {
          return new le(n(t), t.useFactory, t.deps || t.dependencies, t.policy)
        }],
        [u("useClass"), function(t) {
          return new le(n(t), function() {
            return new t.useClass
          }, [], t.policy)
        }],
        [u("useValue"), function(t) {
          return new le(n(t), function() {
            return t.useValue
          }, [], t.policy, t.useValue)
        }],
        [u("useExisting"), function(t) {
          return new le(n(t), z, [t.useExisting], t.policy)
        }]
      ]),
      o = w([
        [a(u("val"), O), function(t) {
          return new le(t.token, z, [t.val], t.policy)
        }],
        [a(u("val"), j), function(t) {
          return new le(t.token, kt(t.val), t.val.slice(0, -1), t.policy)
        }],
        [a(u("val"), P), function(t) {
          return new le(t.token, t.val, (e = t.val, r = N.$injector, e.$inject || r && r.annotate(e, r.strictDi) || "deferred"), t.policy);
          var e, r
        }]
      ]),
      s = w([
        [v(le), function(t) {
          return t
        }],
        [function(t) {
          return !(!t.token || !t.resolveFn)
        }, i],
        [function(t) {
          return !(!t.provide && !t.token || !(t.useValue || t.useFactory || t.useExisting || t.useClass))
        }, i],
        [function(t) {
          return !!(t && t.val && (O(t.val) || j(t.val) || P(t.val)))
        }, o],
        [y(!0), function(t) {
          throw new Error("Invalid resolve value: " + Pe(t))
        }]
      ]),
      c = t.resolve;
    return (j(c) ? c : (e = c, r = t.resolvePolicy || {}, Object.keys(e || {}).map(function(t) {
      return {
        token: t,
        val: e[t],
        deps: void 0,
        policy: r[t]
      }
    }))).map(s)
  }
  var Be = function() {
      function t(t, e) {
        this.matcher = t;
        var r = this,
          n = function() {
            return t.find("")
          },
          i = function(t) {
            return "" === t.name
          };
        this.builders = {
          name: [Ae],
          self: [He],
          parent: [function(e) {
            return i(e) ? null : t.find(r.parentName(e)) || n()
          }],
          data: [qe],
          url: [De(e, n)],
          navigable: [Ne(i)],
          params: [Fe(e.paramFactory)],
          views: [],
          path: [Ue],
          includes: [Le],
          resolvables: [Me]
        }
      }
      return t.prototype.builder = function(t, e) {
        var r = this.builders,
          n = r[t] || [];
        return O(t) && !E(e) ? n.length > 1 ? n : n[0] : O(t) && P(e) ? (r[t] = n, r[t].push(e), function() {
          return r[t].splice(r[t].indexOf(e, 1)) && null
        }) : void 0
      }, t.prototype.build = function(t) {
        var e = this.matcher,
          r = this.builders,
          n = this.parentName(t);
        if (n && !e.find(n, void 0, !1)) return null;
        for (var i in r)
          if (r.hasOwnProperty(i)) {
            var o = r[i].reduce(function(t, e) {
              return function(r) {
                return e(r, t)
              }
            }, J);
            t[i] = o(t)
          }
        return t
      }, t.prototype.parentName = function(t) {
        var e = t.name || "",
          r = e.split(".");
        if ("**" === r.pop() && r.pop(), r.length) {
          if (t.parent) throw new Error("States that specify the 'parent:' property should not have a '.' in their name (" + e + ")");
          return r.join(".")
        }
        return t.parent ? O(t.parent) ? t.parent : t.parent.name : ""
      }, t.prototype.name = function(t) {
        var e = t.name;
        if (-1 !== e.indexOf(".") || !t.parent) return e;
        var r = O(t.parent) ? t.parent : t.parent.name;
        return r ? r + "." + e : e
      }, t
    }(),
    Ge = function() {
      function t(t) {
        this._states = t
      }
      return t.prototype.isRelative = function(t) {
        return 0 === (t = t || "").indexOf(".") || 0 === t.indexOf("^")
      }, t.prototype.find = function(t, e, r) {
        if (void 0 === r && (r = !0), t || "" === t) {
          var n = O(t),
            i = n ? t : t.name;
          this.isRelative(i) && (i = this.resolvePath(i, e));
          var o = this._states[i];
          if (o && (n || !(n || o !== t && o.self !== t))) return o;
          if (n && r) {
            var a = dt(this._states).filter(function(t) {
              return t.__stateObjectCache.nameGlob && t.__stateObjectCache.nameGlob.matches(i)
            });
            return a.length > 1 && console.log("stateMatcher.find: Found multiple matches for " + i + " using glob: ", a.map(function(t) {
              return t.name
            })), a[0]
          }
        }
      }, t.prototype.resolvePath = function(t, e) {
        if (!e) throw new Error("No reference point given for path '" + t + "'");
        for (var r = this.find(e), n = t.split("."), i = 0, o = n.length, a = r; i < o; i++)
          if ("" !== n[i] || 0 !== i) {
            if ("^" !== n[i]) break;
            if (!a.parent) throw new Error("Path '" + t + "' not valid for state '" + r.name + "'");
            a = a.parent
          } else a = r;
        var u = n.slice(i).join(".");
        return a.name + (a.name && u ? "." : "") + u
      }, t
    }(),
    We = function() {
      function t(t, e, r, n, i) {
        this.$registry = t, this.$urlRouter = e, this.states = r, this.builder = n, this.listeners = i, this.queue = [], this.matcher = t.matcher
      }
      return t.prototype.dispose = function() {
        this.queue = []
      }, t.prototype.register = function(t) {
        var e = this.queue,
          r = $.create(t),
          n = r.name;
        if (!O(n)) throw new Error("State must have a valid name");
        if (this.states.hasOwnProperty(n) || Y(e.map(u("name")), n)) throw new Error("State '" + n + "' is already defined");
        return e.push(r), this.flush(), r
      }, t.prototype.flush = function() {
        for (var t = this, e = this.queue, r = this.states, n = this.builder, i = [], o = [], a = {}, u = function(e) {
            return t.states.hasOwnProperty(e) && t.states[e]
          }; e.length > 0;) {
          var s = e.shift(),
            c = s.name,
            f = n.build(s),
            l = o.indexOf(s);
          if (f) {
            var h = u(c);
            if (h && h.name === c) throw new Error("State '" + c + "' is already defined");
            var p = u(c + ".**");
            p && this.$registry.deregister(p), r[c] = s, this.attachRoute(s), l >= 0 && o.splice(l, 1), i.push(s)
          } else {
            var d = a[c];
            if (a[c] = e.length, l >= 0 && d === e.length) return e.push(s), r;
            l < 0 && o.push(s), e.push(s)
          }
        }
        return i.length && this.listeners.forEach(function(t) {
          return t("registered", i.map(function(t) {
            return t.self
          }))
        }), r
      }, t.prototype.attachRoute = function(t) {
        !t.abstract && t.url && this.$urlRouter.rule(this.$urlRouter.urlRuleFactory.create(t))
      }, t
    }(),
    ze = function() {
      function t(t) {
        this._router = t, this.states = {}, this.listeners = [], this.matcher = new Ge(this.states), this.builder = new Be(this.matcher, t.urlMatcherFactory), this.stateQueue = new We(this, t.urlRouter, this.states, this.builder, this.listeners), this._registerRoot()
      }
      return t.prototype._registerRoot = function() {
        (this._root = this.stateQueue.register({
          name: "",
          url: "^",
          views: null,
          params: {
            "#": {
              value: null,
              type: "hash",
              dynamic: !0
            }
          },
          abstract: !0
        })).navigable = null
      }, t.prototype.dispose = function() {
        var t = this;
        this.stateQueue.dispose(), this.listeners = [], this.get().forEach(function(e) {
          return t.get(e) && t.deregister(e)
        })
      }, t.prototype.onStatesChanged = function(t) {
        return this.listeners.push(t),
          function() {
            X(this.listeners)(t)
          }.bind(this)
      }, t.prototype.root = function() {
        return this._root
      }, t.prototype.register = function(t) {
        return this.stateQueue.register(t)
      }, t.prototype._deregisterTree = function(t) {
        var e = this,
          r = this.get().map(function(t) {
            return t.$$state()
          }),
          n = function(t) {
            var e = r.filter(function(e) {
              return -1 !== t.indexOf(e.parent)
            });
            return 0 === e.length ? e : e.concat(n(e))
          },
          i = n([t]),
          o = [t].concat(i).reverse();
        return o.forEach(function(t) {
          var r = e._router.urlRouter;
          r.rules().filter(s("state", t)).forEach(r.removeRule.bind(r)), delete e.states[t.name]
        }), o
      }, t.prototype.deregister = function(t) {
        var e = this.get(t);
        if (!e) throw new Error("Can't deregister state; not found: " + t);
        var r = this._deregisterTree(e.$$state());
        return this.listeners.forEach(function(t) {
          return t("deregistered", r.map(function(t) {
            return t.self
          }))
        }), r
      }, t.prototype.get = function(t, e) {
        var r = this;
        if (0 === arguments.length) return Object.keys(this.states).map(function(t) {
          return r.states[t].self
        });
        var n = this.matcher.find(t, e);
        return n && n.self || null
      }, t.prototype.decorator = function(t, e) {
        return this.builder.builder(t, e)
      }, t
    }();

  function Je(t, e) {
    var r = ["", ""],
      n = t.replace(/[\\\[\]\^$*+?.()|{}]/g, "\\$&");
    if (!e) return n;
    switch (e.squash) {
      case !1:
        r = ["(", ")" + (e.isOptional ? "?" : "")];
        break;
      case !0:
        n = n.replace(/\/$/, ""), r = ["(?:/(", ")|/)?"];
        break;
      default:
        r = ["(" + e.squash + "|", ")?"]
    }
    return n + r[0] + e.type.pattern.source + r[1]
  }
  var Qe = Oe("/"),
    Ke = function() {
      function e(t, r, n, i) {
        var o = this;
        this.config = i, this._cache = {
          path: [this]
        }, this._children = [], this._params = [], this._segments = [], this._compiled = [], this.pattern = t, this.config = it(this.config, {
          params: {},
          strict: !0,
          caseInsensitive: !1,
          paramMap: z
        });
        for (var a, u, c, f = /([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g, l = /([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g, h = 0, p = [], d = function(r) {
            if (!e.nameValidator.test(r)) throw new Error("Invalid parameter name '" + r + "' in pattern '" + t + "'");
            if (lt(o._params, s("id", r))) throw new Error("Duplicate parameter name '" + r + "' in pattern '" + t + "'")
          }, v = function(e, n) {
            var i, a = e[2] || e[3],
              u = n ? e[4] : e[4] || ("*" === e[1] ? "[\\s\\S]*" : null);
            return {
              id: a,
              regexp: u,
              cfg: o.config.params[a],
              segment: t.substring(h, e.index),
              type: u ? r.type(u) || (i = u, K(r.type(n ? "query" : "path"), {
                pattern: new RegExp(i, o.config.caseInsensitive ? "i" : void 0)
              })) : null
            }
          };
          (a = f.exec(t)) && !((u = v(a, !1)).segment.indexOf("?") >= 0);) d(u.id), this._params.push(n.fromPath(u.id, u.type, this.config.paramMap(u.cfg, !1))), this._segments.push(u.segment), p.push([u.segment, kt(this._params)]), h = f.lastIndex;
        var m = (c = t.substring(h)).indexOf("?");
        if (m >= 0) {
          var y = c.substring(m);
          if (c = c.substring(0, m), y.length > 0)
            for (h = 0; a = l.exec(y);) d((u = v(a, !0)).id), this._params.push(n.fromSearch(u.id, u.type, this.config.paramMap(u.cfg, !0))), h = f.lastIndex
        }
        this._segments.push(c), this._compiled = p.map(function(t) {
          return Je.apply(null, t)
        }).concat(Je(c))
      }
      return e.prototype.append = function(t) {
        return this._children.push(t), t._cache = {
          path: this._cache.path.concat(t),
          parent: this,
          pattern: null
        }, t
      }, e.prototype.isRoot = function() {
        return this._cache.path[0] === this
      }, e.prototype.toString = function() {
        return this.pattern
      }, e.prototype.exec = function(t, e, r, n) {
        var i = this;
        void 0 === e && (e = {}), void 0 === n && (n = {});
        var o, a, s, c = (o = this._cache, a = "pattern", s = function() {
          return new RegExp(["^", $t(i._cache.path.map(u("_compiled"))).join(""), !1 === i.config.strict ? "/?" : "", "$"].join(""), i.config.caseInsensitive ? "i" : void 0)
        }, o[a] = o[a] || s()).exec(t);
        if (!c) return null;
        var f, l = this.parameters(),
          h = l.filter(function(t) {
            return !t.isSearch()
          }),
          p = l.filter(function(t) {
            return t.isSearch()
          }),
          d = this._cache.path.map(function(t) {
            return t._segments.length - 1
          }).reduce(function(t, e) {
            return t + e
          }),
          v = {};
        if (d !== c.length - 1) throw new Error("Unbalanced capture group in route '" + this.pattern + "'");
        for (var m = 0; m < d; m++) {
          for (var y = h[m], g = c[m + 1], w = 0; w < y.replace.length; w++) y.replace[w].from === g && (g = y.replace[w].to);
          g && !0 === y.array && (void 0, g = pt(pt((f = function(t) {
            return t.split("").reverse().join("")
          })(g).split(/-(?!\\)/), f), function(t) {
            return t.replace(/\\-/g, "-")
          }).reverse()), E(g) && (g = y.type.decode(g)), v[y.id] = y.value(g)
        }
        return p.forEach(function(t) {
          for (var r = e[t.id], n = 0; n < t.replace.length; n++) t.replace[n].from === r && (r = t.replace[n].to);
          E(r) && (r = t.type.decode(r)), v[t.id] = t.value(r)
        }), r && (v["#"] = r), v
      }, e.prototype.parameters = function(t) {
        return void 0 === t && (t = {}), !1 === t.inherit ? this._params : $t(this._cache.path.map(function(t) {
          return t._params
        }))
      }, e.prototype.parameter = function(t, e) {
        var r = this;
        void 0 === e && (e = {});
        var n = this._cache.parent;
        return function() {
          for (var e = 0, n = r._params; e < n.length; e++) {
            var i = n[e];
            if (i.id === t) return i
          }
        }() || !1 !== e.inherit && n && n.parameter(t, e) || null
      }, e.prototype.validates = function(t) {
        return t = t || {}, this.parameters().filter(function(e) {
          return t.hasOwnProperty(e.id)
        }).map(function(e) {
          return r = e, n = t[e.id], !r || r.validates(n);
          var r, n
        }).reduce(vt, !0)
      }, e.prototype.format = function(t) {
        void 0 === t && (t = {});
        var r = this._cache.path,
          n = r.map(e.pathSegmentsAndParams).reduce(yt, []).map(function(t) {
            return O(t) ? t : o(t)
          }),
          i = r.map(e.queryParams).reduce(yt, []).map(o);
        if (n.concat(i).filter(function(t) {
            return !1 === t.isValid
          }).length) return null;

        function o(e) {
          var r = e.value(t[e.id]),
            n = e.validates(r),
            i = e.isDefaultValue(r);
          return {
            param: e,
            value: r,
            isValid: n,
            isDefaultValue: i,
            squash: !!i && e.squash,
            encoded: e.type.encode(r)
          }
        }
        var a = n.reduce(function(t, r) {
            if (O(r)) return t + r;
            var n = r.squash,
              i = r.encoded,
              o = r.param;
            return !0 === n ? t.match(/\/$/) ? t.slice(0, -1) : t : O(n) ? t + n : !1 !== n ? t : null == i ? t : j(i) ? t + pt(i, e.encodeDashes).join("-") : o.raw ? t + i : t + encodeURIComponent(i)
          }, ""),
          u = i.map(function(t) {
            var e = t.param,
              r = t.squash,
              n = t.encoded,
              i = t.isDefaultValue;
            if (!(null == n || i && !1 !== r) && (j(n) || (n = [n]), 0 !== n.length)) return e.raw || (n = pt(n, encodeURIComponent)), n.map(function(t) {
              return e.id + "=" + t
            })
          }).filter(z).reduce(yt, []).join("&");
        return a + (u ? "?" + u : "") + (t["#"] ? "#" + t["#"] : "")
      }, e.encodeDashes = function(t) {
        return encodeURIComponent(t).replace(/-/g, function(t) {
          return "%5C%" + t.charCodeAt(0).toString(16).toUpperCase()
        })
      }, e.pathSegmentsAndParams = function(e) {
        return Ct(e._segments, e._params.filter(function(e) {
          return e.location === t.DefType.PATH
        }).concat(void 0)).reduce(yt, []).filter(function(t) {
          return "" !== t && E(t)
        })
      }, e.queryParams = function(e) {
        return e._params.filter(function(e) {
          return e.location === t.DefType.SEARCH
        })
      }, e.compare = function(t, r) {
        var n, i, o = function(t) {
            return t._cache.weights = t._cache.weights || (r = t, r._cache.segments = r._cache.segments || r._cache.path.map(e.pathSegmentsAndParams).reduce(yt, []).reduce(xe, []).map(function(t) {
              return O(t) ? Qe(t) : t
            }).reduce(yt, [])).map(function(t) {
              return "/" === t ? 1 : O(t) ? 2 : t instanceof ue ? 3 : void 0
            });
            var r
          },
          a = Ct(o(t), o(r));
        for (i = 0; i < a.length; i++)
          if (0 !== (n = a[i][0] - a[i][1])) return n;
        return 0
      }, e.nameValidator = /^\w+([-.]+\w+)*(?:\[\])?$/, e
    }(),
    Ye = function() {
      function e() {
        var e = this;
        this.paramTypes = new Ie, this._isCaseInsensitive = !1, this._isStrictMode = !0, this._defaultSquashPolicy = !1, this._getConfig = function(t) {
          return G({
            strict: e._isStrictMode,
            caseInsensitive: e._isCaseInsensitive
          }, t)
        }, this.paramFactory = {
          fromConfig: function(r, n, i) {
            return new ue(r, n, i, t.DefType.CONFIG, e)
          },
          fromPath: function(r, n, i) {
            return new ue(r, n, i, t.DefType.PATH, e)
          },
          fromSearch: function(r, n, i) {
            return new ue(r, n, i, t.DefType.SEARCH, e)
          }
        }, G(this, {
          UrlMatcher: Ke,
          Param: ue
        })
      }
      return e.prototype.caseInsensitive = function(t) {
        return this._isCaseInsensitive = E(t) ? t : this._isCaseInsensitive
      }, e.prototype.strictMode = function(t) {
        return this._isStrictMode = E(t) ? t : this._isStrictMode
      }, e.prototype.defaultSquashPolicy = function(t) {
        if (E(t) && !0 !== t && !1 !== t && !O(t)) throw new Error("Invalid squash policy: " + t + ". Valid policies: false, true, arbitrary-string");
        return this._defaultSquashPolicy = E(t) ? t : this._defaultSquashPolicy
      }, e.prototype.compile = function(t, e) {
        return new Ke(t, this.paramTypes, this.paramFactory, this._getConfig(e))
      }, e.prototype.isMatcher = function(t) {
        if (!x(t)) return !1;
        var e = !0;
        return B(Ke.prototype, function(r, n) {
          P(r) && (e = e && E(t[n]) && P(t[n]))
        }), e
      }, e.prototype.type = function(t, e, r) {
        var n = this.paramTypes.type(t, e, r);
        return E(e) ? this : n
      }, e.prototype.$get = function() {
        return this.paramTypes.enqueue = !1, this.paramTypes._flushTypeQueue(), this
      }, e.prototype.dispose = function() {
        this.paramTypes.dispose()
      }, e
    }(),
    Ze = function() {
      function t(t) {
        this.router = t
      }
      return t.prototype.compile = function(t) {
        return this.router.urlMatcherFactory.compile(t)
      }, t.prototype.create = function(t, e) {
        var r = this,
          n = w([
            [O, function(t) {
              return n(r.compile(t))
            }],
            [v(Ke), function(t) {
              return r.fromUrlMatcher(t, e)
            }],
            [A, function(t) {
              return r.fromState(t, r.router)
            }],
            [v(RegExp), function(t) {
              return r.fromRegExp(t, e)
            }],
            [P, function(t) {
              return new Xe(t, e)
            }]
          ]),
          i = n(t);
        if (!i) throw new Error("invalid 'what' in when()");
        return i
      }, t.prototype.fromUrlMatcher = function(t, e) {
        var r = e;
        O(e) && (e = this.router.urlMatcherFactory.compile(e)), v(Ke)(e) && (r = function(t) {
          return e.format(t)
        });
        var n = {
          urlMatcher: t,
          matchPriority: function(e) {
            var r = t.parameters().filter(function(t) {
              return t.isOptional
            });
            return r.length ? r.filter(function(t) {
              return e[t.id]
            }).length / r.length : 1e-6
          },
          type: "URLMATCHER"
        };
        return G(new Xe(function(e) {
          var r = t.exec(e.path, e.search, e.hash);
          return t.validates(r) && r
        }, r), n)
      }, t.prototype.fromState = function(t, e) {
        var r = {
          state: t,
          type: "STATE"
        };
        return G(this.fromUrlMatcher(t.url, function(r) {
          var n = e.stateService,
            i = e.globals;
          n.href(t, r) !== n.href(i.current, i.params) && n.transitionTo(t, r, {
            inherit: !0,
            source: "url"
          })
        }), r)
      }, t.prototype.fromRegExp = function(t, e) {
        if (t.global || t.sticky) throw new Error("Rule RegExp must not be global or sticky");
        var r = O(e) ? function(t) {
            return e.replace(/\$(\$|\d{1,2})/, function(e, r) {
              return t["$" === r ? 0 : Number(r)]
            })
          } : e,
          n = {
            regexp: t,
            type: "REGEXP"
          };
        return G(new Xe(function(e) {
          return t.exec(e.path)
        }, r), n)
      }, t.isUrlRule = function(t) {
        return t && ["type", "match", "handler"].every(function(e) {
          return E(t[e])
        })
      }, t
    }(),
    Xe = function() {
      return function(t, e) {
        var r = this;
        this.match = t, this.type = "RAW", this.matchPriority = function(t) {
          return 0 - r.$id
        }, this.handler = e || z
      }
    }();
  var tr, er = u("urlMatcher");
  tr = Vt(It(a(u("priority"), function(t) {
    return -t
  })), It(a(u("type"), function(t) {
    return {
      STATE: 4,
      URLMATCHER: 4,
      REGEXP: 3,
      RAW: 2,
      OTHER: 1
    }[t]
  })), function(t, e) {
    return er(t) && er(e) ? Ke.compare(er(t), er(e)) : 0
  }, It(u("$id"), Y(["REGEXP", "RAW", "OTHER"])));
  var rr = function() {
    function t(e) {
      this._sortFn = tr, this._rules = [], this.interceptDeferred = !1, this._id = 0, this._sorted = !1, this._router = e, this.urlRuleFactory = new Ze(e), Q(y(t.prototype), this, y(this))
    }
    return t.prototype.dispose = function() {
      this.listen(!1), this._rules = [], delete this._otherwiseFn
    }, t.prototype.sort = function(t) {
      this._rules.sort(this._sortFn = t || this._sortFn), this._sorted = !0
    }, t.prototype.ensureSorted = function() {
      this._sorted || this.sort()
    }, t.prototype.match = function(t) {
      var e = this;
      this.ensureSorted(), t = G({
        path: "",
        search: {},
        hash: ""
      }, t);
      var r = this.rules();
      this._otherwiseFn && r.push(this._otherwiseFn);
      for (var n, i, o, a = 0; a < r.length && (!n || 0 === this._sortFn(r[a], n.rule)); a++) {
        var u = (i = r[a], void 0, (o = i.match(t, e._router)) && {
          match: o,
          rule: i,
          weight: i.matchPriority(o)
        });
        n = !n || u && u.weight > n.weight ? u : n
      }
      return n
    }, t.prototype.sync = function(t) {
      if (!t || !t.defaultPrevented) {
        var e = this._router,
          r = e.urlService,
          n = e.stateService,
          i = {
            path: r.path(),
            search: r.search(),
            hash: r.hash()
          },
          o = this.match(i);
        w([
          [O, function(t) {
            return r.url(t, !0)
          }],
          [Kt.isDef, function(t) {
            return n.go(t.state, t.params, t.options)
          }],
          [v(Kt), function(t) {
            return n.go(t.state(), t.params(), t.options())
          }]
        ])(o && o.rule.handler(o.match, i, e))
      }
    }, t.prototype.listen = function(t) {
      var e = this;
      if (!1 !== t) return this._stopFn = this._stopFn || this._router.urlService.onChange(function(t) {
        return e.sync(t)
      });
      this._stopFn && this._stopFn(), delete this._stopFn
    }, t.prototype.update = function(t) {
      var e = this._router.locationService;
      t ? this.location = e.path() : e.path() !== this.location && e.url(this.location, !0)
    }, t.prototype.push = function(t, e, r) {
      var n = r && !!r.replace;
      this._router.urlService.url(t.format(e || {}), n)
    }, t.prototype.href = function(t, e, r) {
      var n = t.format(e);
      if (null == n) return null;
      r = r || {
        absolute: !1
      };
      var i, o, a, u, s = this._router.urlService.config,
        c = s.html5Mode();
      if (c || null === n || (n = "#" + s.hashPrefix() + n), i = n, o = c, a = r.absolute, n = "/" === (u = s.baseHref()) ? i : o ? u.slice(0, -1) + i : a ? u.slice(1) + i : i, !r.absolute || !n) return n;
      var f = !c && n ? "/" : "",
        l = s.port();
      return l = 80 === l || 443 === l ? "" : ":" + l, [s.protocol(), "://", s.host(), l, f, n].join("")
    }, t.prototype.rule = function(t) {
      var e = this;
      if (!Ze.isUrlRule(t)) throw new Error("invalid rule");
      return t.$id = this._id++, t.priority = t.priority || 0, this._rules.push(t), this._sorted = !1,
        function() {
          return e.removeRule(t)
        }
    }, t.prototype.removeRule = function(t) {
      X(this._rules, t)
    }, t.prototype.rules = function() {
      return this.ensureSorted(), this._rules.slice()
    }, t.prototype.otherwise = function(t) {
      var e = nr(t);
      this._otherwiseFn = this.urlRuleFactory.create(y(!0), e), this._sorted = !1
    }, t.prototype.initial = function(t) {
      var e = nr(t);
      this.rule(this.urlRuleFactory.create(function(t, e) {
        return 0 === e.globals.transitionHistory.size() && !!/^\/?$/.exec(t.path)
      }, e))
    }, t.prototype.when = function(t, e, r) {
      var n = this.urlRuleFactory.create(t, e);
      return E(r && r.priority) && (n.priority = r.priority), this.rule(n), n
    }, t.prototype.deferIntercept = function(t) {
      void 0 === t && (t = !0), this.interceptDeferred = t
    }, t
  }();

  function nr(t) {
    if (!(P(t) || O(t) || v(Kt)(t) || Kt.isDef(t))) throw new Error("'handler' must be a string, function, TargetState, or have a state: 'newtarget' property");
    return P(t) ? t : y(t)
  }
  var ir = function() {
      function t() {
        var t = this;
        this._uiViews = [], this._viewConfigs = [], this._viewConfigFactories = {}, this._pluginapi = {
          _rootViewContext: this._rootViewContext.bind(this),
          _viewConfigFactory: this._viewConfigFactory.bind(this),
          _registeredUIViews: function() {
            return t._uiViews
          },
          _activeViewConfigs: function() {
            return t._viewConfigs
          }
        }
      }
      return t.prototype._rootViewContext = function(t) {
        return this._rootContext = t || this._rootContext
      }, t.prototype._viewConfigFactory = function(t, e) {
        this._viewConfigFactories[t] = e
      }, t.prototype.createViewConfig = function(t, e) {
        var r = this._viewConfigFactories[e.$type];
        if (!r) throw new Error("ViewService: No view config factory registered for type " + e.$type);
        var n = r(t, e);
        return j(n) ? n : [n]
      }, t.prototype.deactivateViewConfig = function(t) {
        Qt.traceViewServiceEvent("<- Removing", t), X(this._viewConfigs, t)
      }, t.prototype.activateViewConfig = function(t) {
        Qt.traceViewServiceEvent("-> Registering", t), this._viewConfigs.push(t)
      }, t.prototype.sync = function() {
        var e = this,
          r = this._uiViews.map(function(t) {
            return [t.fqn, t]
          }).reduce(Pt, {});

        function n(t) {
          for (var e = t.viewDecl.$context, r = 0; ++r && e.parent;) e = e.parent;
          return r
        }
        var o = i(function(t, e, r, n) {
            return e * (t(r) - t(n))
          }),
          a = this._uiViews.sort(o(function(t) {
            var e = function(t) {
              return t && t.parent ? e(t.parent) + 1 : 1
            };
            return 1e4 * t.fqn.split(".").length + e(t.creationContext)
          }, 1)).map(function(i) {
            var a = e._viewConfigs.filter(t.matches(r, i));
            return a.length > 1 && a.sort(o(n, -1)), [i, a[0]]
          });
        Qt.traceViewSync(a), a.forEach(function(t) {
          var r = t[0],
            n = t[1]; - 1 !== e._uiViews.indexOf(r) && r.configUpdated(n)
        })
      }, t.prototype.registerUIView = function(t) {
        Qt.traceViewServiceUIViewEvent("-> Registering", t);
        var e = this._uiViews;
        return e.filter(function(e) {
            return e.fqn === t.fqn && e.$type === t.$type
          }).length && Qt.traceViewServiceUIViewEvent("!!!! duplicate uiView named:", t), e.push(t), this.sync(),
          function() {
            -1 !== e.indexOf(t) ? (Qt.traceViewServiceUIViewEvent("<- Deregistering", t), X(e)(t)) : Qt.traceViewServiceUIViewEvent("Tried removing non-registered uiView", t)
          }
      }, t.prototype.available = function() {
        return this._uiViews.map(u("fqn"))
      }, t.prototype.active = function() {
        return this._uiViews.filter(u("$config")).map(u("name"))
      }, t.normalizeUIViewTarget = function(t, e) {
        void 0 === e && (e = "");
        var r = e.split("@"),
          n = r[0] || "$default",
          i = O(r[1]) ? r[1] : "^",
          o = /^(\^(?:\.\^)*)\.(.*$)/.exec(n);
        o && (i = o[1], n = o[2]), "!" === n.charAt(0) && (n = n.substr(1), i = "");
        /^(\^(?:\.\^)*)$/.exec(i) ? i = i.split(".").reduce(function(t, e) {
          return t.parent
        }, t).name : "." === i && (i = t.name);
        return {
          uiViewName: n,
          uiViewContextAnchor: i
        }
      }, t.matches = function(t, e) {
        return function(r) {
          if (e.$type !== r.viewDecl.$type) return !1;
          var n = r.viewDecl,
            i = n.$uiViewName.split("."),
            o = e.fqn.split(".");
          if (!W(i, o.slice(0 - i.length))) return !1;
          var a = 1 - i.length || void 0,
            u = o.slice(0, a).join("."),
            s = t[u].creationContext;
          return n.$uiViewContextAnchor === (s && s.name)
        }
      }, t
    }(),
    or = function() {
      function t() {
        this.params = new Ve, this.lastStartedTransitionId = -1, this.transitionHistory = new qt([], 1), this.successfulTransitions = new qt([], 1)
      }
      return t.prototype.dispose = function() {
        this.transitionHistory.clear(), this.successfulTransitions.clear(), this.transition = null
      }, t
    }(),
    ar = function(t) {
      return t.reduce(function(t, e) {
        return t[e] = D(e), t
      }, {
        dispose: J
      })
    },
    ur = ["url", "path", "search", "hash", "onChange"],
    sr = ["port", "protocol", "host", "baseHref", "html5Mode", "hashPrefix"],
    cr = ["type", "caseInsensitive", "strictMode", "defaultSquashPolicy"],
    fr = ["sort", "when", "initial", "otherwise", "rules", "rule", "removeRule"],
    lr = ["deferIntercept", "listen", "sync", "match"],
    hr = function() {
      function t(t, e) {
        void 0 === e && (e = !0), this.router = t, this.rules = {}, this.config = {};
        var r = function() {
          return t.locationService
        };
        Q(r, this, r, ur, e);
        var n = function() {
          return t.locationConfig
        };
        Q(n, this.config, n, sr, e);
        var i = function() {
          return t.urlMatcherFactory
        };
        Q(i, this.config, i, cr);
        var o = function() {
          return t.urlRouter
        };
        Q(o, this.rules, o, fr), Q(o, this, o, lr)
      }
      return t.prototype.url = function(t, e, r) {}, t.prototype.path = function() {}, t.prototype.search = function() {}, t.prototype.hash = function() {}, t.prototype.onChange = function(t) {}, t.prototype.parts = function() {
        return {
          path: this.path(),
          search: this.search(),
          hash: this.hash()
        }
      }, t.prototype.dispose = function() {}, t.prototype.sync = function(t) {}, t.prototype.listen = function(t) {}, t.prototype.deferIntercept = function(t) {}, t.prototype.match = function(t) {}, t.locationServiceStub = ar(ur), t.locationConfigStub = ar(sr), t
    }(),
    pr = 0,
    dr = function() {
      function t(t, e) {
        void 0 === t && (t = hr.locationServiceStub), void 0 === e && (e = hr.locationConfigStub), this.locationService = t, this.locationConfig = e, this.$id = pr++, this._disposed = !1, this._disposables = [], this.trace = Qt, this.viewService = new ir, this.transitionService = new Ir(this), this.globals = new or, this.urlMatcherFactory = new Ye, this.urlRouter = new rr(this), this.stateRegistry = new ze(this), this.stateService = new Vr(this), this.urlService = new hr(this), this._plugins = {}, this.viewService._pluginapi._rootViewContext(this.stateRegistry.root()), this.globals.$current = this.stateRegistry.root(), this.globals.current = this.globals.$current.self, this.disposable(this.globals), this.disposable(this.stateService), this.disposable(this.stateRegistry), this.disposable(this.transitionService), this.disposable(this.urlRouter), this.disposable(t), this.disposable(e)
      }
      return t.prototype.disposable = function(t) {
        this._disposables.push(t)
      }, t.prototype.dispose = function(t) {
        var e = this;
        t && P(t.dispose) ? t.dispose(this) : (this._disposed = !0, this._disposables.slice().forEach(function(t) {
          try {
            "function" == typeof t.dispose && t.dispose(e), X(e._disposables, t)
          } catch (t) {}
        }))
      }, t.prototype.plugin = function(t, e) {
        void 0 === e && (e = {});
        var r = new t(this, e);
        if (!r.name) throw new Error("Required property `name` missing on plugin: " + r);
        return this._disposables.push(r), this._plugins[r.name] = r
      }, t.prototype.getPlugin = function(t) {
        return t ? this._plugins[t] : dt(this._plugins)
      }, t
    }();

  function vr(t) {
    t.addResolvable({
      token: dr,
      deps: [],
      resolveFn: function() {
        return t.router
      },
      data: t.router
    }, ""), t.addResolvable({
      token: _e,
      deps: [],
      resolveFn: function() {
        return t
      },
      data: t
    }, ""), t.addResolvable({
      token: "$transition$",
      deps: [],
      resolveFn: function() {
        return t
      },
      data: t
    }, ""), t.addResolvable({
      token: "$stateParams",
      deps: [],
      resolveFn: function() {
        return t.params()
      },
      data: t.params()
    }, ""), t.entering().forEach(function(e) {
      t.addResolvable({
        token: "$state$",
        deps: [],
        resolveFn: function() {
          return e
        },
        data: e
      }, e)
    })
  }
  var mr = function(t) {
    var e = t.to().redirectTo;
    if (e) {
      var r = t.router.stateService;
      return P(e) ? N.$q.when(e(t)).then(n) : n(e)
    }

    function n(e) {
      if (e) return e instanceof Kt ? e : O(e) ? r.target(e, t.params(), t.options()) : e.state || e.params ? r.target(e.state || t.to(), e.params || t.params(), t.options()) : void 0
    }
  };

  function yr(t) {
    return function(e, r) {
      return (0, r.$$state()[t])(e, r)
    }
  }
  var gr = yr("onExit"),
    wr = yr("onRetain"),
    _r = yr("onEnter"),
    $r = function(t) {
      return new ye(t.treeChanges().to).resolvePath("EAGER", t).then(J)
    },
    Sr = function(t, e) {
      return new ye(t.treeChanges().to).subContext(e.$$state()).resolvePath("LAZY", t).then(J)
    },
    Rr = function(t) {
      var e = N.$q,
        r = t.views("entering");
      if (r.length) return e.all(r.map(function(t) {
        return e.when(t.load())
      })).then(J)
    },
    br = function(t) {
      var e = t.views("entering"),
        r = t.views("exiting");
      if (e.length || r.length) {
        var n = t.router.viewService;
        r.forEach(function(t) {
          return n.deactivateViewConfig(t)
        }), e.forEach(function(t) {
          return n.activateViewConfig(t)
        }), n.sync()
      }
    },
    Er = function(t) {
      var e = t.router.globals,
        r = function() {
          e.transition === t && (e.transition = null)
        };
      t.onSuccess({}, function() {
        e.successfulTransitions.enqueue(t), e.$current = t.$to(), e.current = e.$current.self, M(t.params(), e.params)
      }, {
        priority: 1e4
      }), t.promise.then(r, r)
    },
    Tr = function(t) {
      var e = t.options(),
        r = t.router.stateService,
        n = t.router.urlRouter;
      if ("url" !== e.source && e.location && r.$current.navigable) {
        var i = {
          replace: "replace" === e.location
        };
        n.push(r.$current.navigable.url, r.params, i)
      }
      n.update(!0)
    },
    Cr = function(t) {
      var e = t.router;
      var r = t.entering().filter(function(t) {
        return !!t.$$state().lazyLoad
      }).map(function(e) {
        return Pr(t, e)
      });
      return N.$q.all(r).then(function() {
        if ("url" !== t.originalTransition().options().source) {
          var r = t.targetState();
          return e.stateService.target(r.identifier(), r.params(), r.options())
        }
        var n = e.urlService,
          i = n.match(n.parts()),
          o = i && i.rule;
        if (o && "STATE" === o.type) {
          var a = o.state,
            u = i.match;
          return e.stateService.target(a, u, t.options())
        }
        e.urlService.sync()
      })
    };

  function Pr(t, e) {
    var r = e.$$state().lazyLoad,
      n = r._promise;
    if (!n) {
      n = r._promise = N.$q.when(r(t, e)).then(function(e) {
        e && Array.isArray(e.states) && e.states.forEach(function(e) {
          return t.router.stateRegistry.register(e)
        });
        return e
      }).then(function(t) {
        return delete e.lazyLoad, delete e.$$state().lazyLoad, delete r._promise, t
      }, function(t) {
        return delete r._promise, N.$q.reject(t)
      })
    }
    return n
  }
  var kr = function() {
    return function(t, e, r, n, i, o, a, u) {
      void 0 === i && (i = !1), void 0 === o && (o = Zt.HANDLE_RESULT), void 0 === a && (a = Zt.REJECT_ERROR), void 0 === u && (u = !1), this.name = t, this.hookPhase = e, this.hookOrder = r, this.criteriaMatchPath = n, this.reverseSort = i, this.getResultHandler = o, this.getErrorHandler = a, this.synchronous = u
    }
  }();

  function Or(t) {
    var e = t._ignoredReason();
    if (e) {
      Qt.traceTransitionIgnored(t);
      var r = t.router.globals.transition;
      return "SameAsCurrent" === e && r && r.abort(), Nt.ignored().toPromise()
    }
  }

  function xr(t) {
    if (!t.valid()) throw new Error(t.error())
  }
  var jr = {
      location: !0,
      relative: null,
      inherit: !1,
      notify: !0,
      reload: !1,
      custom: {},
      current: function() {
        return null
      },
      source: "unknown"
    },
    Ir = function() {
      function e(t) {
        this._transitionCount = 0, this._eventTypes = [], this._registeredHooks = {}, this._criteriaPaths = {}, this._router = t, this.$view = t.viewService, this._deregisterHookFns = {}, this._pluginapi = Q(y(this), {}, y(this), ["_definePathType", "_defineEvent", "_getPathTypes", "_getEvents", "getHooks"]), this._defineCorePaths(), this._defineCoreEvents(), this._registerCoreTransitionHooks()
      }
      return e.prototype.onCreate = function(t, e, r) {}, e.prototype.onBefore = function(t, e, r) {}, e.prototype.onStart = function(t, e, r) {}, e.prototype.onExit = function(t, e, r) {}, e.prototype.onRetain = function(t, e, r) {}, e.prototype.onEnter = function(t, e, r) {}, e.prototype.onFinish = function(t, e, r) {}, e.prototype.onSuccess = function(t, e, r) {}, e.prototype.onError = function(t, e, r) {}, e.prototype.dispose = function(t) {
        dt(this._registeredHooks).forEach(function(t) {
          return t.forEach(function(e) {
            e._deregistered = !0, X(t, e)
          })
        })
      }, e.prototype.create = function(t, e) {
        return new _e(t, e, this._router)
      }, e.prototype._defineCoreEvents = function() {
        var e = t.TransitionHookPhase,
          r = Zt,
          n = this._criteriaPaths;
        this._defineEvent("onCreate", e.CREATE, 0, n.to, !1, r.LOG_REJECTED_RESULT, r.THROW_ERROR, !0), this._defineEvent("onBefore", e.BEFORE, 0, n.to), this._defineEvent("onStart", e.RUN, 0, n.to), this._defineEvent("onExit", e.RUN, 100, n.exiting, !0), this._defineEvent("onRetain", e.RUN, 200, n.retained), this._defineEvent("onEnter", e.RUN, 300, n.entering), this._defineEvent("onFinish", e.RUN, 400, n.to), this._defineEvent("onSuccess", e.SUCCESS, 0, n.to, !1, r.LOG_REJECTED_RESULT, r.LOG_ERROR, !0), this._defineEvent("onError", e.ERROR, 0, n.to, !1, r.LOG_REJECTED_RESULT, r.LOG_ERROR, !0)
      }, e.prototype._defineCorePaths = function() {
        var e = t.TransitionHookScope.STATE,
          r = t.TransitionHookScope.TRANSITION;
        this._definePathType("to", r), this._definePathType("from", r), this._definePathType("exiting", e), this._definePathType("retained", e), this._definePathType("entering", e)
      }, e.prototype._defineEvent = function(t, e, r, n, i, o, a, u) {
        void 0 === i && (i = !1), void 0 === o && (o = Zt.HANDLE_RESULT), void 0 === a && (a = Zt.REJECT_ERROR), void 0 === u && (u = !1);
        var s = new kr(t, e, r, n, i, o, a, u);
        this._eventTypes.push(s), ee(this, this, s)
      }, e.prototype._getEvents = function(t) {
        return (E(t) ? this._eventTypes.filter(function(e) {
          return e.hookPhase === t
        }) : this._eventTypes.slice()).sort(function(t, e) {
          var r = t.hookPhase - e.hookPhase;
          return 0 === r ? t.hookOrder - e.hookOrder : r
        })
      }, e.prototype._definePathType = function(t, e) {
        this._criteriaPaths[t] = {
          name: t,
          scope: e
        }
      }, e.prototype._getPathTypes = function() {
        return this._criteriaPaths
      }, e.prototype.getHooks = function(t) {
        return this._registeredHooks[t]
      }, e.prototype._registerCoreTransitionHooks = function() {
        var t = this._deregisterHookFns;
        t.addCoreResolves = this.onCreate({}, vr), t.ignored = this.onBefore({}, Or, {
          priority: -9999
        }), t.invalid = this.onBefore({}, xr, {
          priority: -1e4
        }), t.redirectTo = this.onStart({
          to: function(t) {
            return !!t.redirectTo
          }
        }, mr), t.onExit = this.onExit({
          exiting: function(t) {
            return !!t.onExit
          }
        }, gr), t.onRetain = this.onRetain({
          retained: function(t) {
            return !!t.onRetain
          }
        }, wr), t.onEnter = this.onEnter({
          entering: function(t) {
            return !!t.onEnter
          }
        }, _r), t.eagerResolve = this.onStart({}, $r, {
          priority: 1e3
        }), t.lazyResolve = this.onEnter({
          entering: y(!0)
        }, Sr, {
          priority: 1e3
        }), t.loadViews = this.onFinish({}, Rr), t.activateViews = this.onSuccess({}, br), t.updateGlobals = this.onCreate({}, Er), t.updateUrl = this.onSuccess({}, Tr, {
          priority: 9999
        }), t.lazyLoad = this.onBefore({
          entering: function(t) {
            return !!t.lazyLoad
          }
        }, Cr)
      }, e
    }(),
    Vr = function() {
      function e(t) {
        this.router = t, this.invalidCallbacks = [], this._defaultErrorHandler = function(t) {
          t instanceof Error && t.stack ? (console.error(t), console.error(t.stack)) : t instanceof Nt ? (console.error(t.toString()), t.detail && t.detail.stack && console.error(t.detail.stack)) : console.error(t)
        };
        var r = Object.keys(e.prototype).filter(f(Y(["current", "$current", "params", "transition"])));
        Q(y(e.prototype), this, y(this), r)
      }
      return Object.defineProperty(e.prototype, "transition", {
        get: function() {
          return this.router.globals.transition
        },
        enumerable: !0,
        configurable: !0
      }), Object.defineProperty(e.prototype, "params", {
        get: function() {
          return this.router.globals.params
        },
        enumerable: !0,
        configurable: !0
      }), Object.defineProperty(e.prototype, "current", {
        get: function() {
          return this.router.globals.current
        },
        enumerable: !0,
        configurable: !0
      }), Object.defineProperty(e.prototype, "$current", {
        get: function() {
          return this.router.globals.$current
        },
        enumerable: !0,
        configurable: !0
      }), e.prototype.dispose = function() {
        this.defaultErrorHandler(J), this.invalidCallbacks = []
      }, e.prototype._handleInvalidTargetState = function(t, e) {
        var r = this,
          n = ce.makeTargetState(t),
          i = this.router.globals,
          o = function() {
            return i.transitionHistory.peekTail()
          },
          a = o(),
          u = new qt(this.invalidCallbacks.slice()),
          s = new ye(t).injector(),
          c = function(t) {
            if (t instanceof Kt) {
              var e = t;
              return (e = r.target(e.identifier(), e.params(), e.options())).valid() ? o() !== a ? Nt.superseded().toPromise() : r.transitionTo(e.identifier(), e.params(), e.options()) : Nt.invalid(e.error()).toPromise()
            }
          };
        return function t() {
          var r = u.dequeue();
          return void 0 === r ? Nt.invalid(e.error()).toPromise() : N.$q.when(r(e, n, s)).then(c).then(function(e) {
            return e || t()
          })
        }()
      }, e.prototype.onInvalid = function(t) {
        return this.invalidCallbacks.push(t),
          function() {
            X(this.invalidCallbacks)(t)
          }.bind(this)
      }, e.prototype.reload = function(t) {
        return this.transitionTo(this.current, this.params, {
          reload: !E(t) || t,
          inherit: !1,
          notify: !1
        })
      }, e.prototype.go = function(t, e, r) {
        var n = it(r, {
          relative: this.$current,
          inherit: !0
        }, jr);
        return this.transitionTo(t, e, n)
      }, e.prototype.target = function(t, e, r) {
        if (void 0 === r && (r = {}), x(r.reload) && !r.reload.name) throw new Error("Invalid reload state object");
        var n = this.router.stateRegistry;
        if (r.reloadState = !0 === r.reload ? n.root() : n.matcher.find(r.reload, r.relative), r.reload && !r.reloadState) throw new Error("No such reload state '" + (O(r.reload) ? r.reload : r.reload.name) + "'");
        var i = n.matcher.find(t, r.relative);
        return new Kt(t, i, e, r)
      }, e.prototype.getCurrentPath = function() {
        var t = this,
          e = this.router.globals.successfulTransitions.peekTail();
        return e ? e.treeChanges().to : [new se(t.router.stateRegistry.root())]
      }, e.prototype.transitionTo = function(e, r, n) {
        var i = this;
        void 0 === r && (r = {}), void 0 === n && (n = {});
        var o = this.router,
          a = o.globals;
        n = it(n, jr);
        n = G(n, {
          current: function() {
            return a.transition
          }
        });
        var u = this.target(e, r, n),
          s = this.getCurrentPath();
        if (!u.exists()) return this._handleInvalidTargetState(s, u);
        if (!u.valid()) return Ht(u.error());
        var c = function(e) {
            return function(r) {
              if (r instanceof Nt) {
                var n = o.globals.lastStartedTransitionId === e.$id;
                if (r.type === t.RejectType.IGNORED) return n && o.urlRouter.update(), N.$q.when(a.current);
                var u = r.detail;
                if (r.type === t.RejectType.SUPERSEDED && r.redirected && u instanceof Kt) {
                  var s = e.redirect(u);
                  return s.run().catch(c(s))
                }
                if (r.type === t.RejectType.ABORTED) return n && o.urlRouter.update(), N.$q.reject(r)
              }
              return i.defaultErrorHandler()(r), N.$q.reject(r)
            }
          },
          f = this.router.transitionService.create(s, u),
          l = f.run().catch(c(f));
        return At(l), G(l, {
          transition: f
        })
      }, e.prototype.is = function(t, e, r) {
        r = it(r, {
          relative: this.$current
        });
        var n = this.router.stateRegistry.matcher.find(t, r.relative);
        if (E(n)) {
          if (this.$current !== n) return !1;
          if (!e) return !0;
          var i = n.parameters({
            inherit: !0,
            matchingKeys: e
          });
          return ue.equals(i, ue.values(i, e), this.params)
        }
      }, e.prototype.includes = function(t, e, r) {
        r = it(r, {
          relative: this.$current
        });
        var n = O(t) && _.fromString(t);
        if (n) {
          if (!n.matches(this.$current.name)) return !1;
          t = this.$current.name
        }
        var i = this.router.stateRegistry.matcher.find(t, r.relative),
          o = this.$current.includes;
        if (E(i)) {
          if (!E(o[i.name])) return !1;
          if (!e) return !0;
          var a = i.parameters({
            inherit: !0,
            matchingKeys: e
          });
          return ue.equals(a, ue.values(a, e), this.params)
        }
      }, e.prototype.href = function(t, e, r) {
        r = it(r, {
          lossy: !0,
          inherit: !0,
          absolute: !1,
          relative: this.$current
        }), e = e || {};
        var n = this.router.stateRegistry.matcher.find(t, r.relative);
        if (!E(n)) return null;
        r.inherit && (e = this.params.$inherit(e, this.$current, n));
        var i = n && r.lossy ? n.navigable : n;
        return i && void 0 !== i.url && null !== i.url ? this.router.urlRouter.href(i.url, e, {
          absolute: r.absolute
        }) : null
      }, e.prototype.defaultErrorHandler = function(t) {
        return this._defaultErrorHandler = t || this._defaultErrorHandler
      }, e.prototype.get = function(t, e) {
        var r = this.router.stateRegistry;
        return 0 === arguments.length ? r.get() : r.get(t, e || this.$current)
      }, e.prototype.lazyLoad = function(t, e) {
        var r = this.get(t);
        if (!r || !r.lazyLoad) throw new Error("Can not lazy load " + t);
        var n = this.getCurrentPath(),
          i = ce.makeTargetState(n);
        return Pr(e = e || this.router.transitionService.create(n, i), r)
      }, e
    }(),
    Ar = {
      when: function(t) {
        return new Promise(function(e, r) {
          return e(t)
        })
      },
      reject: function(t) {
        return new Promise(function(e, r) {
          r(t)
        })
      },
      defer: function() {
        var t = {};
        return t.promise = new Promise(function(e, r) {
          t.resolve = e, t.reject = r
        }), t
      },
      all: function(t) {
        if (j(t)) return Promise.all(t);
        if (x(t)) {
          var e = Object.keys(t).map(function(e) {
            return t[e].then(function(t) {
              return {
                key: e,
                val: t
              }
            })
          });
          return Ar.all(e).then(function(t) {
            return t.reduce(function(t, e) {
              return t[e.key] = e.val, t
            }, {})
          })
        }
      }
    },
    Hr = {},
    qr = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,
    Dr = /([^\s,]+)/g,
    Nr = {
      get: function(t) {
        return Hr[t]
      },
      has: function(t) {
        return null != Nr.get(t)
      },
      invoke: function(t, e, r) {
        var n = G({}, Hr, r || {}),
          i = Nr.annotate(t),
          o = Rt(function(t) {
            return n.hasOwnProperty(t)
          }, function(t) {
            return "DI can't find injectable: '" + t + "'"
          }),
          a = i.filter(o).map(function(t) {
            return n[t]
          });
        return P(t) ? t.apply(e, a) : t.slice(-1)[0].apply(e, a)
      },
      annotate: function(t) {
        if (!H(t)) throw new Error("Not an injectable function: " + t);
        if (t && t.$inject) return t.$inject;
        if (j(t)) return t.slice(0, -1);
        var e = t.toString().replace(qr, "");
        return e.slice(e.indexOf("(") + 1, e.indexOf(")")).match(Dr) || []
      }
    },
    Fr = function(t) {
      return function(e) {
        if (!e) return ["", ""];
        var r = e.indexOf(t);
        return -1 === r ? [e, ""] : [e.substr(0, r), e.substr(r + 1)]
      }
    },
    Ur = Fr("#"),
    Lr = Fr("?"),
    Mr = Fr("="),
    Br = function(t) {
      return t ? t.replace(/^#/, "") : ""
    },
    Gr = function(t, e) {
      var r = e[0],
        n = e[1];
      return t.hasOwnProperty(r) ? j(t[r]) ? t[r].push(n) : t[r] = [t[r], n] : t[r] = n, t
    },
    Wr = function(t) {
      return t.split("&").filter(z).map(Mr).reduce(Gr, {})
    };

  function zr(t) {
    var e = function(t) {
        return t || ""
      },
      r = Ur(t).map(e),
      n = r[0],
      i = r[1],
      o = Lr(n).map(e);
    return {
      path: o[0],
      search: o[1],
      hash: i,
      url: t
    }
  }
  var Jr = function(t) {
    var e = t.path(),
      r = t.search(),
      n = t.hash(),
      i = Object.keys(r).map(function(t) {
        var e = r[t];
        return (j(e) ? e : [e]).map(function(e) {
          return t + "=" + e
        })
      }).reduce(yt, []).join("&");
    return e + (i ? "?" + i : "") + (n ? "#" + n : "")
  };

  function Qr(t, e, r, n) {
    return function(i) {
      var o = i.locationService = new r(i),
        a = i.locationConfig = new n(i, e);
      return {
        name: t,
        service: o,
        configuration: a,
        dispose: function(t) {
          t.dispose(o), t.dispose(a)
        }
      }
    }
  }
  var Kr, Yr, Zr, Xr = function() {
      function t(t, e) {
        var r = this;
        this.fireAfterUpdate = e, this._listener = function(t) {
          return r._listeners.forEach(function(e) {
            return e(t)
          })
        }, this._listeners = [], this.hash = function() {
          return zr(r._get()).hash
        }, this.path = function() {
          return zr(r._get()).path
        }, this.search = function() {
          return Wr(zr(r._get()).search)
        }, this._location = window && window.location, this._history = window && window.history
      }
      return t.prototype.url = function(t, e) {
        if (void 0 === e && (e = !0), E(t) && t !== this._get() && (this._set(null, null, t, e), this.fireAfterUpdate)) {
          var r = G(new Event("locationchange"), {
            url: t
          });
          this._listeners.forEach(function(t) {
            return t(r)
          })
        }
        return Jr(this)
      }, t.prototype.onChange = function(t) {
        var e = this;
        return this._listeners.push(t),
          function() {
            return X(e._listeners, t)
          }
      }, t.prototype.dispose = function(t) {
        nt(this._listeners)
      }, t
    }(),
    tn = (Kr = Object.setPrototypeOf || {
        __proto__: []
      }
      instanceof Array && function(t, e) {
        t.__proto__ = e
      } || function(t, e) {
        for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r])
      },
      function(t, e) {
        function r() {
          this.constructor = t
        }
        Kr(t, e), t.prototype = null === e ? Object.create(e) : (r.prototype = e.prototype, new r)
      }),
    en = function(t) {
      function e(e) {
        var r = t.call(this, e, !1) || this;
        return window.addEventListener("hashchange", r._listener, !1), r
      }
      return tn(e, t), e.prototype._get = function() {
        return Br(this._location.hash)
      }, e.prototype._set = function(t, e, r, n) {
        this._location.hash = r
      }, e.prototype.dispose = function(e) {
        t.prototype.dispose.call(this, e), window.removeEventListener("hashchange", this._listener)
      }, e
    }(Xr),
    rn = (Yr = Object.setPrototypeOf || {
        __proto__: []
      }
      instanceof Array && function(t, e) {
        t.__proto__ = e
      } || function(t, e) {
        for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r])
      },
      function(t, e) {
        function r() {
          this.constructor = t
        }
        Yr(t, e), t.prototype = null === e ? Object.create(e) : (r.prototype = e.prototype, new r)
      }),
    nn = function(t) {
      function e(e) {
        return t.call(this, e, !0) || this
      }
      return rn(e, t), e.prototype._get = function() {
        return this._url
      }, e.prototype._set = function(t, e, r, n) {
        this._url = r
      }, e
    }(Xr),
    on = (Zr = Object.setPrototypeOf || {
        __proto__: []
      }
      instanceof Array && function(t, e) {
        t.__proto__ = e
      } || function(t, e) {
        for (var r in e) e.hasOwnProperty(r) && (t[r] = e[r])
      },
      function(t, e) {
        function r() {
          this.constructor = t
        }
        Zr(t, e), t.prototype = null === e ? Object.create(e) : (r.prototype = e.prototype, new r)
      }),
    an = function(t) {
      function e(e) {
        var r = t.call(this, e, !0) || this;
        return r._config = e.urlService.config, window.addEventListener("popstate", r._listener, !1), r
      }
      return on(e, t), e.prototype._get = function() {
        var t = this._location,
          e = t.pathname,
          r = t.hash,
          n = t.search;
        return n = Lr(n)[1], r = Ur(r)[1], e + (n ? "?" + n : "") + (r ? "$" + n : "")
      }, e.prototype._set = function(t, e, r, n) {
        var i = this._config,
          o = this._history,
          a = i.baseHref() + r;
        n ? o.replaceState(t, e, a) : o.pushState(t, e, a)
      }, e.prototype.dispose = function(e) {
        t.prototype.dispose.call(this, e), window.removeEventListener("popstate", this._listener)
      }, e
    }(Xr),
    un = function() {
      return function() {
        var t = this;
        this._baseHref = "", this._port = 80, this._protocol = "http", this._host = "localhost", this._hashPrefix = "", this.port = function() {
          return t._port
        }, this.protocol = function() {
          return t._protocol
        }, this.host = function() {
          return t._host
        }, this.baseHref = function() {
          return t._baseHref
        }, this.html5Mode = function() {
          return !1
        }, this.hashPrefix = function(e) {
          return E(e) ? t._hashPrefix = e : t._hashPrefix
        }, this.dispose = J
      }
    }(),
    sn = function() {
      function t(t, e) {
        void 0 === e && (e = !1), this._isHtml5 = e, this._baseHref = void 0, this._hashPrefix = ""
      }
      return t.prototype.port = function() {
        return location.port ? Number(location.port) : "https" === this.protocol() ? 443 : 80
      }, t.prototype.protocol = function() {
        return location.protocol.replace(/:/g, "")
      }, t.prototype.host = function() {
        return location.host
      }, t.prototype.html5Mode = function() {
        return this._isHtml5
      }, t.prototype.hashPrefix = function(t) {
        return E(t) ? this._hashPrefix = t : this._hashPrefix
      }, t.prototype.baseHref = function(t) {
        return E(t) ? this._baseHref = t : this._baseHref || this.applyDocumentBaseHref()
      }, t.prototype.applyDocumentBaseHref = function() {
        var t = document.getElementsByTagName("base");
        return this._baseHref = t.length ? t[0].href.substr(location.origin.length) : ""
      }, t.prototype.dispose = function() {}, t
    }();

  function cn(t) {
    return N.$injector = Nr, N.$q = Ar, {
      name: "vanilla.services",
      $q: Ar,
      $injector: Nr,
      dispose: function() {
        return null
      }
    }
  }
  var fn = Qr("vanilla.hashBangLocation", !1, en, sn),
    ln = Qr("vanilla.pushStateLocation", !0, an, sn),
    hn = Qr("vanilla.memoryLocation", !1, nn, un),
    pn = function() {
      function t() {}
      return t.prototype.dispose = function(t) {}, t
    }(),
    dn = Object.freeze({
      fromJson: U,
      toJson: L,
      copy: M,
      forEach: B,
      extend: G,
      equals: W,
      identity: z,
      noop: J,
      createProxyFunctions: Q,
      inherit: K,
      inArray: Y,
      _inArray: Z,
      removeFrom: X,
      _removeFrom: tt,
      pushTo: et,
      _pushTo: rt,
      deregAll: nt,
      defaults: it,
      mergeR: ot,
      ancestors: at,
      pick: ut,
      omit: st,
      pluck: ct,
      filter: ft,
      find: lt,
      mapObj: ht,
      map: pt,
      values: dt,
      allTrueR: vt,
      anyTrueR: mt,
      unnestR: yt,
      flattenR: gt,
      pushR: wt,
      uniqR: _t,
      unnest: $t,
      flatten: St,
      assertPredicate: Rt,
      assertMap: bt,
      assertFn: Et,
      pairs: Tt,
      arrayTuples: Ct,
      applyPairs: Pt,
      tail: kt,
      _extend: Ot,
      sortBy: It,
      composeSort: Vt,
      silenceUncaughtInPromise: At,
      silentRejection: Ht,
      notImplemented: D,
      services: N,
      Glob: _,
      curry: i,
      compose: o,
      pipe: a,
      prop: u,
      propEq: s,
      parse: c,
      not: f,
      and: l,
      or: h,
      all: p,
      any: d,
      is: v,
      eq: m,
      val: y,
      invoke: g,
      pattern: w,
      isUndefined: b,
      isDefined: E,
      isNull: T,
      isNullOrUndefined: C,
      isFunction: P,
      isNumber: k,
      isString: O,
      isObject: x,
      isArray: j,
      isDate: I,
      isRegExp: V,
      isState: A,
      isInjectable: H,
      isPromise: q,
      Queue: qt,
      maxLength: $e,
      padString: Se,
      kebobString: Re,
      functionToString: be,
      fnToString: Ee,
      stringify: Pe,
      beforeAfterSubstr: ke,
      splitOnDelim: Oe,
      joinNeighborsR: xe,
      get Category() {
        return t.Category
      },
      Trace: Jt,
      trace: Qt,
      get DefType() {
        return t.DefType
      },
      Param: ue,
      ParamTypes: Ie,
      StateParams: Ve,
      ParamType: ne,
      PathNode: se,
      PathUtils: ce,
      resolvePolicies: he,
      defaultResolvePolicy: fe,
      Resolvable: le,
      NATIVE_INJECTOR_TOKEN: me,
      ResolveContext: ye,
      resolvablesBuilder: Me,
      StateBuilder: Be,
      StateObject: $,
      StateMatcher: Ge,
      StateQueueManager: We,
      StateRegistry: ze,
      StateService: Vr,
      TargetState: Kt,
      get TransitionHookPhase() {
        return t.TransitionHookPhase
      },
      get TransitionHookScope() {
        return t.TransitionHookScope
      },
      HookBuilder: re,
      matchState: Xt,
      RegisteredHook: te,
      makeEvent: ee,
      get RejectType() {
        return t.RejectType
      },
      Rejection: Nt,
      Transition: _e,
      TransitionHook: Zt,
      TransitionEventType: kr,
      defaultTransOpts: jr,
      TransitionService: Ir,
      UrlMatcher: Ke,
      UrlMatcherFactory: Ye,
      UrlRouter: rr,
      UrlRuleFactory: Ze,
      BaseUrlRule: Xe,
      UrlService: hr,
      ViewService: ir,
      UIRouterGlobals: or,
      UIRouter: dr,
      $q: Ar,
      $injector: Nr,
      BaseLocationServices: Xr,
      HashLocationService: en,
      MemoryLocationService: nn,
      PushStateLocationService: an,
      MemoryLocationConfig: un,
      BrowserLocationConfig: sn,
      splitHash: Ur,
      splitQuery: Lr,
      splitEqual: Mr,
      trimHashVal: Br,
      keyValsToObjectR: Gr,
      getParams: Wr,
      parseUrl: zr,
      buildUrl: Jr,
      locationPluginFactory: Qr,
      servicesPlugin: cn,
      hashLocationPlugin: fn,
      pushStateLocationPlugin: ln,
      memoryLocationPlugin: hn,
      UIRouterPluginBase: pn
    });

  function vn() {
    var t = null;
    return function(e, r) {
      return t = t || N.$injector.get("$templateFactory"), [new wn(e, r, t)]
    }
  }
  var mn = function(t, e) {
    return t.reduce(function(t, r) {
      return t || E(e[r])
    }, !1)
  };

  function yn(t) {
    if (!t.parent) return {};
    var e = ["component", "bindings", "componentProvider"],
      r = ["templateProvider", "templateUrl", "template", "notify", "async"].concat(["controller", "controllerProvider", "controllerAs", "resolveAs"]),
      n = e.concat(r);
    if (E(t.views) && mn(n, t)) throw new Error("State '" + t.name + "' has a 'views' object. It cannot also have \"view properties\" at the state level.  Move the following properties into a view (in the 'views' object):  " + n.filter(function(e) {
      return E(t[e])
    }).join(", "));
    var i = {},
      o = t.views || {
        $default: ut(t, n)
      };
    return B(o, function(n, o) {
      if (o = o || "$default", O(n) && (n = {
          component: n
        }), n = G({}, n), mn(e, n) && mn(r, n)) throw new Error("Cannot combine: " + e.join("|") + " with: " + r.join("|") + " in stateview: '" + o + "@" + t.name + "'");
      n.resolveAs = n.resolveAs || "$resolve", n.$type = "ng1", n.$context = t, n.$name = o;
      var a = ir.normalizeUIViewTarget(n.$context, n.$name);
      n.$uiViewName = a.uiViewName, n.$uiViewContextAnchor = a.uiViewContextAnchor, i[o] = n
    }), i
  }
  var gn = 0,
    wn = function() {
      function t(t, e, r) {
        var n = this;
        this.path = t, this.viewDecl = e, this.factory = r, this.$id = gn++, this.loaded = !1, this.getTemplate = function(t, e) {
          return n.component ? n.factory.makeComponentTemplate(t, e, n.component, n.viewDecl.bindings) : n.template
        }
      }
      return t.prototype.load = function() {
        var t = this,
          e = N.$q,
          r = new ye(this.path),
          n = this.path.reduce(function(t, e) {
            return G(t, e.paramValues)
          }, {}),
          i = {
            template: e.when(this.factory.fromConfig(this.viewDecl, n, r)),
            controller: e.when(this.getController(r))
          };
        return e.all(i).then(function(e) {
          return Qt.traceViewServiceEvent("Loaded", t), t.controller = e.controller, G(t, e.template), t
        })
      }, t.prototype.getController = function(t) {
        var e = this.viewDecl.controllerProvider;
        if (!H(e)) return this.viewDecl.controller;
        var r = N.$injector.annotate(e),
          n = j(e) ? kt(e) : e;
        return new le("", n, r).get(t)
      }, t
    }(),
    _n = function() {
      function t() {
        var t = this;
        this._useHttp = n.version.minor < 3, this.$get = ["$http", "$templateCache", "$injector", function(e, r, n) {
          return t.$templateRequest = n.has && n.has("$templateRequest") && n.get("$templateRequest"), t.$http = e, t.$templateCache = r, t
        }]
      }
      return t.prototype.useHttpService = function(t) {
        this._useHttp = t
      }, t.prototype.fromConfig = function(t, e, r) {
        var n = function(t) {
            return N.$q.when(t).then(function(t) {
              return {
                template: t
              }
            })
          },
          i = function(t) {
            return N.$q.when(t).then(function(t) {
              return {
                component: t
              }
            })
          };
        return E(t.template) ? n(this.fromString(t.template, e)) : E(t.templateUrl) ? n(this.fromUrl(t.templateUrl, e)) : E(t.templateProvider) ? n(this.fromProvider(t.templateProvider, e, r)) : E(t.component) ? i(t.component) : E(t.componentProvider) ? i(this.fromComponentProvider(t.componentProvider, e, r)) : n("<ui-view></ui-view>")
      }, t.prototype.fromString = function(t, e) {
        return P(t) ? t(e) : t
      }, t.prototype.fromUrl = function(t, e) {
        return P(t) && (t = t(e)), null == t ? null : this._useHttp ? this.$http.get(t, {
          cache: this.$templateCache,
          headers: {
            Accept: "text/html"
          }
        }).then(function(t) {
          return t.data
        }) : this.$templateRequest(t)
      }, t.prototype.fromProvider = function(t, e, r) {
        var n = N.$injector.annotate(t),
          i = j(t) ? kt(t) : t;
        return new le("", i, n).get(r)
      }, t.prototype.fromComponentProvider = function(t, e, r) {
        var n = N.$injector.annotate(t),
          i = j(t) ? kt(t) : t;
        return new le("", i, n).get(r)
      }, t.prototype.makeComponentTemplate = function(t, e, r, i) {
        i = i || {};
        var o = n.version.minor >= 3 ? "::" : "",
          a = function(t) {
            var e = Re(t);
            return /^(x|data)-/.exec(e) ? "x-" + e : e
          },
          u = function(t) {
            var e = N.$injector.get(t + "Directive");
            if (!e || !e.length) throw new Error("Unable to find component named '" + t + "'");
            return e.map($n).reduce(yt, [])
          }(r).map(function(r) {
            var n = r.name,
              u = r.type,
              s = a(n);
            if (t.attr(s) && !i[n]) return s + "='" + t.attr(s) + "'";
            var c = i[n] || n;
            if ("@" === u) return s + "='{{" + o + "$resolve." + c + "}}'";
            if ("&" === u) {
              var f = e.getResolvable(c),
                l = f && f.data,
                h = l && N.$injector.annotate(l) || [];
              return s + "='$resolve." + c + (j(l) ? "[" + (l.length - 1) + "]" : "") + "(" + h.join(",") + ")'"
            }
            return s + "='" + o + "$resolve." + c + "'"
          }).join(" "),
          s = a(r);
        return "<" + s + " " + u + "></" + s + ">"
      }, t
    }();
  var $n = function(t) {
      return x(t.bindToController) ? Sn(t.bindToController) : Sn(t.scope)
    },
    Sn = function(t) {
      return Object.keys(t || {}).map(function(e) {
        return [e, /^([=<@&])[?]?(.*)/.exec(t[e])]
      }).filter(function(t) {
        return E(t) && j(t[1])
      }).map(function(t) {
        return {
          name: t[1][2] || t[0],
          type: t[1][1]
        }
      })
    },
    Rn = function() {
      function t(e, r) {
        this.stateRegistry = e, this.stateService = r, Q(y(t.prototype), this, y(this))
      }
      return t.prototype.decorator = function(t, e) {
        return this.stateRegistry.decorator(t, e) || this
      }, t.prototype.state = function(t, e) {
        return x(t) ? e = t : e.name = t, this.stateRegistry.register(e), this
      }, t.prototype.onInvalid = function(t) {
        return this.stateService.onInvalid(t)
      }, t
    }(),
    bn = function(t) {
      return function(e, r) {
        var n = e[t],
          i = "onExit" === t ? "from" : "to";
        return n ? function(t, e) {
          var r = new ye(t.treeChanges(i)),
            o = G(Un(r), {
              $state$: e,
              $transition$: t
            });
          return N.$injector.invoke(n, this, o)
        } : void 0
      }
    },
    En = function() {
      function t(t) {
        this._urlListeners = [], this.$locationProvider = t;
        var e = y(t);
        Q(e, this, e, ["hashPrefix"])
      }
      return t.prototype.dispose = function() {}, t.prototype.onChange = function(t) {
        var e = this;
        return this._urlListeners.push(t),
          function() {
            return X(e._urlListeners)(t)
          }
      }, t.prototype.html5Mode = function() {
        var t = this.$locationProvider.html5Mode();
        return (t = x(t) ? t.enabled : t) && this.$sniffer.history
      }, t.prototype.url = function(t, e, r) {
        return void 0 === e && (e = !1), t && this.$location.url(t), e && this.$location.replace(), r && this.$location.state(r), this.$location.url()
      }, t.prototype._runtimeServices = function(t, e, r, n) {
        var i = this;
        this.$location = e, this.$sniffer = r, t.$on("$locationChangeSuccess", function(t) {
          return i._urlListeners.forEach(function(e) {
            return e(t)
          })
        });
        var o = y(e),
          a = y(n);
        Q(o, this, o, ["replace", "path", "search", "hash"]), Q(o, this, o, ["port", "protocol", "host"]), Q(a, this, a, ["baseHref"])
      }, t.monkeyPatchPathParameterType = function(t) {
        var e = t.urlMatcherFactory.type("path");
        e.encode = function(t) {
          return null != t ? t.toString().replace(/(~|\/)/g, function(t) {
            return {
              "~": "~~",
              "/": "~2F"
            }[t]
          }) : t
        }, e.decode = function(t) {
          return null != t ? t.toString().replace(/(~~|~2F)/g, function(t) {
            return {
              "~~": "~",
              "~2F": "/"
            }[t]
          }) : t
        }
      }, t
    }(),
    Tn = function() {
      function t(t) {
        this._router = t, this._urlRouter = t.urlRouter
      }
      return t.prototype.$get = function() {
        var t = this._urlRouter;
        return t.update(!0), t.interceptDeferred || t.listen(), t
      }, t.prototype.rule = function(t) {
        var e = this;
        if (!P(t)) throw new Error("'rule' must be a function");
        var r = new Xe(function() {
          return t(N.$injector, e._router.locationService)
        }, z);
        return this._urlRouter.rule(r), this
      }, t.prototype.otherwise = function(t) {
        var e = this,
          r = this._urlRouter;
        if (O(t)) r.otherwise(t);
        else {
          if (!P(t)) throw new Error("'rule' must be a string or function");
          r.otherwise(function() {
            return t(N.$injector, e._router.locationService)
          })
        }
        return this
      }, t.prototype.when = function(e, r) {
        return (j(r) || P(r)) && (r = t.injectableHandler(this._router, r)), this._urlRouter.when(e, r), this
      }, t.injectableHandler = function(t, e) {
        return function(r) {
          return N.$injector.invoke(e, null, {
            $match: r,
            $stateParams: t.globals.params
          })
        }
      }, t.prototype.deferIntercept = function(t) {
        this._urlRouter.deferIntercept(t)
      }, t
    }();
  n.module("ui.router.angular1", []);
  var Cn = n.module("ui.router.init", []),
    Pn = n.module("ui.router.util", ["ng", "ui.router.init"]),
    kn = n.module("ui.router.router", ["ui.router.util"]),
    On = n.module("ui.router.state", ["ui.router.router", "ui.router.util", "ui.router.angular1"]),
    xn = n.module("ui.router", ["ui.router.init", "ui.router.state", "ui.router.angular1"]),
    jn = (n.module("ui.router.compat", ["ui.router"]), null);

  function In(t) {
    (jn = this.router = new dr).stateProvider = new Rn(jn.stateRegistry, jn.stateService), jn.stateRegistry.decorator("views", yn), jn.stateRegistry.decorator("onExit", bn("onExit")), jn.stateRegistry.decorator("onRetain", bn("onRetain")), jn.stateRegistry.decorator("onEnter", bn("onEnter")), jn.viewService._pluginapi._viewConfigFactory("ng1", vn());
    var e = jn.locationService = jn.locationConfig = new En(t);

    function r(t, r, n, i, o, a) {
      return e._runtimeServices(i, t, n, r), delete jn.router, delete jn.$get, jn
    }
    return En.monkeyPatchPathParameterType(jn), jn.router = jn, jn.$get = r, r.$inject = ["$location", "$browser", "$sniffer", "$rootScope", "$http", "$templateCache"], jn
  }
  In.$inject = ["$locationProvider"];
  var Vn = function(t) {
    return ["$uiRouterProvider", function(e) {
      var r = e.router[t];
      return r.$get = function() {
        return r
      }, r
    }]
  };

  function An(t, e, r) {
    N.$injector = t, N.$q = e, r.stateRegistry.get().map(function(t) {
      return t.$$state().resolvables
    }).reduce(yt, []).filter(function(t) {
      return "deferred" === t.deps
    }).forEach(function(e) {
      return e.deps = t.annotate(e.resolveFn, t.strictDi)
    })
  }
  An.$inject = ["$injector", "$q", "$uiRouter"];

  function Hn(t) {
    t.$watch(function() {
      Qt.approximateDigests++
    })
  }
  Hn.$inject = ["$rootScope"], Cn.provider("$uiRouter", In), kn.provider("$urlRouter", ["$uiRouterProvider", function(t) {
    return t.urlRouterProvider = new Tn(t)
  }]), Pn.provider("$urlService", Vn("urlService")), Pn.provider("$urlMatcherFactory", ["$uiRouterProvider", function() {
    return jn.urlMatcherFactory
  }]), Pn.provider("$templateFactory", function() {
    return new _n
  }), On.provider("$stateRegistry", Vn("stateRegistry")), On.provider("$uiRouterGlobals", Vn("globals")), On.provider("$transitions", Vn("transitionService")), On.provider("$state", ["$uiRouterProvider", function() {
    return G(jn.stateProvider, {
      $get: function() {
        return jn.stateService
      }
    })
  }]), On.factory("$stateParams", ["$uiRouter", function(t) {
    return t.globals.params
  }]), xn.factory("$view", function() {
    return jn.viewService
  }), xn.service("$trace", function() {
    return Qt
  }), xn.run(Hn), Pn.run(["$urlMatcherFactory", function(t) {}]), On.run(["$state", function(t) {}]), kn.run(["$urlRouter", function(t) {}]), Cn.run(An);
  var qn, Dn, Nn, Fn, Un = function(t) {
    return t.getTokens().filter(O).map(function(e) {
      var r = t.getResolvable(e);
      return [e, "NOWAIT" === t.getPolicy(r).async ? r.promise : r.data]
    }).reduce(Pt, {})
  };

  function Ln(t) {
    var e, r = t.match(/^\s*({[^}]*})\s*$/);
    if (r && (t = "(" + r[1] + ")"), !(e = t.replace(/\n/g, " ").match(/^\s*([^(]*?)\s*(\((.*)\))?\s*$/)) || 4 !== e.length) throw new Error("Invalid state ref '" + t + "'");
    return {
      state: e[1] || null,
      paramExpr: e[3] || null
    }
  }

  function Mn(t) {
    var e = t.parent().inheritedData("$uiView"),
      r = c("$cfg.path")(e);
    return r ? kt(r).state.name : void 0
  }

  function Bn(t, e, r) {
    var n, i = r.uiState || t.current.name,
      o = G((n = t, {
        relative: Mn(e) || n.$current,
        inherit: !0,
        source: "sref"
      }), r.uiStateOpts || {}),
      a = t.href(i, r.uiStateParams, o);
    return {
      uiState: i,
      uiStateParams: r.uiStateParams,
      uiStateOpts: o,
      href: a
    }
  }

  function Gn(t) {
    var e = "[object SVGAnimatedString]" === Object.prototype.toString.call(t.prop("href")),
      r = "FORM" === t[0].nodeName;
    return {
      attr: r ? "action" : e ? "xlink:href" : "href",
      isAnchor: "A" === t.prop("tagName").toUpperCase(),
      clickable: !r
    }
  }

  function Wn(t, e, r, n, i) {
    return function(o) {
      var a = o.which || o.button,
        u = i();
      if (!(a > 1 || o.ctrlKey || o.metaKey || o.shiftKey || t.attr("target"))) {
        var s = r(function() {
          e.go(u.uiState, u.uiStateParams, u.uiStateOpts)
        });
        o.preventDefault();
        var c = n.isAnchor && !u.href ? 1 : 0;
        o.preventDefault = function() {
          c-- <= 0 && r.cancel(s)
        }
      }
    }
  }

  function zn(t, e, r, n) {
    var i;
    n && (i = n.events), j(i) || (i = ["click"]);
    for (var o = t.on ? "on" : "bind", a = 0, u = i; a < u.length; a++) {
      var s = u[a];
      t[o](s, r)
    }
    e.$on("$destroy", function() {
      for (var e = t.off ? "off" : "unbind", n = 0, o = i; n < o.length; n++) {
        var a = o[n];
        t[e](a, r)
      }
    })
  }

  function Jn(t) {
    var e = function(e, r, n) {
      return t.is(e, r, n)
    };
    return e.$stateful = !0, e
  }

  function Qn(t) {
    var e = function(e, r, n) {
      return t.includes(e, r, n)
    };
    return e.$stateful = !0, e
  }

  function Kn(t, r, i, o, a, u) {
    var s = c("viewDecl.controllerAs"),
      f = c("viewDecl.resolveAs");
    return {
      restrict: "ECA",
      priority: -400,
      compile: function(o) {
        var u = o.html();
        return o.empty(),
          function(o, c) {
            var l = c.data("$uiView");
            if (!l) return c.html(u), void t(c.contents())(o);
            var h = l.$cfg || {
                viewDecl: {},
                getTemplate: e.noop
              },
              p = h.path && new ye(h.path);
            c.html(h.getTemplate(c, p) || u), Qt.traceUIViewFill(l.$uiView, c.html());
            var d = t(c.contents()),
              v = h.controller,
              m = s(h),
              y = f(h),
              g = p && Un(p);
            if (o[y] = g, v) {
              var w = r(v, G({}, g, {
                $scope: o,
                $element: c
              }));
              m && (o[m] = w, o[m][y] = g), c.data("$ngControllerController", w), c.children().data("$ngControllerController", w), Xn(a, i, w, o, h)
            }
            if (O(h.viewDecl.component)) var _ = h.viewDecl.component,
              $ = Re(_),
              S = new RegExp("^(x-|data-)?" + $ + "$", "i"),
              R = o.$watch(function() {
                var t = [].slice.call(c[0].children).filter(function(t) {
                  return t && t.tagName && S.exec(t.tagName)
                });
                return t && n.element(t).data("$" + _ + "Controller")
              }, function(t) {
                t && (Xn(a, i, t, o, h), R())
              });
            d(o)
          }
      }
    }
  }
  qn = ["$uiRouter", "$timeout", function(t, e) {
    var r = t.stateService;
    return {
      restrict: "A",
      require: ["?^uiSrefActive", "?^uiSrefActiveEq"],
      link: function(n, i, o, a) {
        var u, s = Gn(i),
          c = a[1] || a[0],
          f = null,
          l = {},
          h = function() {
            return Bn(r, i, l)
          },
          p = Ln(o.uiSref);

        function d() {
          var t = h();
          f && f(), c && (f = c.$$addStateInfo(t.uiState, t.uiStateParams)), null != t.href && o.$set(s.attr, t.href)
        }
        l.uiState = p.state, l.uiStateOpts = o.uiSrefOpts ? n.$eval(o.uiSrefOpts) : {}, p.paramExpr && (n.$watch(p.paramExpr, function(t) {
          l.uiStateParams = G({}, t), d()
        }, !0), l.uiStateParams = G({}, n.$eval(p.paramExpr))), d(), n.$on("$destroy", t.stateRegistry.onStatesChanged(d)), n.$on("$destroy", t.transitionService.onSuccess({}, d)), s.clickable && (u = Wn(i, r, e, s, h), zn(i, n, u, l.uiStateOpts))
      }
    }
  }], Dn = ["$uiRouter", "$timeout", function(t, e) {
    var r = t.stateService;
    return {
      restrict: "A",
      require: ["?^uiSrefActive", "?^uiSrefActiveEq"],
      link: function(n, i, o, a) {
        var u, s = Gn(i),
          c = a[1] || a[0],
          f = null,
          l = {},
          h = function() {
            return Bn(r, i, l)
          },
          p = ["uiState", "uiStateParams", "uiStateOpts"],
          d = p.reduce(function(t, e) {
            return t[e] = J, t
          }, {});

        function v() {
          var t = h();
          f && f(), c && (f = c.$$addStateInfo(t.uiState, t.uiStateParams)), null != t.href && o.$set(s.attr, t.href)
        }
        p.forEach(function(t) {
          l[t] = o[t] ? n.$eval(o[t]) : null, o.$observe(t, function(e) {
            d[t](), d[t] = n.$watch(e, function(e) {
              l[t] = e, v()
            }, !0)
          })
        }), v(), n.$on("$destroy", t.stateRegistry.onStatesChanged(v)), n.$on("$destroy", t.transitionService.onSuccess({}, v)), s.clickable && (u = Wn(i, r, e, s, h), zn(i, n, u, l.uiStateOpts))
      }
    }
  }], Nn = ["$state", "$stateParams", "$interpolate", "$uiRouter", function(t, e, r, n) {
    return {
      restrict: "A",
      controller: ["$scope", "$element", "$attrs", function(e, i, o) {
        var a, u, s = [];
        a = r(o.uiSrefActiveEq || "", !1)(e);
        try {
          u = e.$eval(o.uiSrefActive)
        } catch (t) {}

        function c(t) {
          t.promise.then(l, J)
        }

        function f(e, r, n) {
          var o = {
            state: t.get(e, Mn(i)) || {
              name: e
            },
            params: r,
            activeClass: n
          };
          return s.push(o),
            function() {
              X(s)(o)
            }
        }

        function l() {
          var r = function(t) {
              return t.split(/\s/).filter(z)
            },
            n = function(t) {
              return t.map(function(t) {
                return t.activeClass
              }).map(r).reduce(yt, [])
            },
            o = n(s).concat(r(a)).reduce(_t, []),
            u = n(s.filter(function(e) {
              return t.includes(e.state.name, e.params)
            })),
            c = !!s.filter(function(e) {
              return t.is(e.state.name, e.params)
            }).length ? r(a) : [],
            f = u.concat(c).reduce(_t, []),
            l = o.filter(function(t) {
              return !Y(f, t)
            });
          e.$evalAsync(function() {
            f.forEach(function(t) {
              return i.addClass(t)
            }), l.forEach(function(t) {
              return i.removeClass(t)
            })
          })
        }
        u = u || r(o.uiSrefActive || "", !1)(e), x(u) && B(u, function(t, r) {
          if (O(t)) {
            var n = Ln(t);
            f(n.state, e.$eval(n.paramExpr), r)
          }
        }), this.$$addStateInfo = function(t, e) {
          if (!(x(u) && s.length > 0)) {
            var r = f(t, e, u);
            return l(), r
          }
        }, e.$on("$stateChangeSuccess", l), e.$on("$destroy", n.transitionService.onStart({}, c)), n.globals.transition && c(n.globals.transition), l()
      }]
    }
  }], n.module("ui.router.state").directive("uiSref", qn).directive("uiSrefActive", Nn).directive("uiSrefActiveEq", Nn).directive("uiState", Dn), Jn.$inject = ["$state"], Qn.$inject = ["$state"], n.module("ui.router.state").filter("isState", Jn).filter("includedByState", Qn), Fn = ["$view", "$animate", "$uiViewScroll", "$interpolate", "$q", function(t, e, r, i, o) {
    var a = {
        $cfg: {
          viewDecl: {
            $context: t._pluginapi._rootViewContext()
          }
        },
        $uiView: {}
      },
      u = {
        count: 0,
        restrict: "ECA",
        terminal: !0,
        priority: 400,
        transclude: "element",
        compile: function(s, f, l) {
          return function(s, f, h) {
            var p, d, v, m, y = h.onload || "",
              g = h.autoscroll,
              w = {
                enter: function(t, r, i) {
                  n.version.minor > 2 ? e.enter(t, null, r).then(i) : e.enter(t, null, r, i)
                },
                leave: function(t, r) {
                  n.version.minor > 2 ? e.leave(t).then(r) : e.leave(t, r)
                }
              },
              _ = void 0,
              $ = f.inheritedData("$uiView") || a,
              S = i(h.uiView || h.name || "")(s) || "$default",
              R = {
                $type: "ng1",
                id: u.count++,
                name: S,
                fqn: $.$uiView.fqn ? $.$uiView.fqn + "." + S : S,
                config: null,
                configUpdated: function(t) {
                  if (t && !(t instanceof wn)) return;
                  if (e = _, r = t, e === r) return;
                  var e, r;
                  Qt.traceUIViewConfigUpdated(R, t && t.viewDecl && t.viewDecl.$context), _ = t, b(t)
                },
                get creationContext() {
                  var t = c("$cfg.viewDecl.$context")($),
                    e = c("$uiView.creationContext")($);
                  return t || e
                }
              };

            function b(t) {
              var e = s.$new(),
                n = o.defer(),
                i = o.defer(),
                a = {
                  $cfg: t,
                  $uiView: R
                },
                u = {
                  $animEnter: n.promise,
                  $animLeave: i.promise,
                  $$animLeave: i
                };
              e.$emit("$viewContentLoading", S);
              var c = l(e, function(t) {
                t.data("$uiViewAnim", u), t.data("$uiView", a), w.enter(t, f, function() {
                    n.resolve(), v && v.$emit("$viewContentAnimationEnded"), (E(g) && !g || s.$eval(g)) && r(t)
                  }),
                  function() {
                    if (p && (Qt.traceUIViewEvent("Removing (previous) el", p.data("$uiView")), p.remove(), p = null), v && (Qt.traceUIViewEvent("Destroying scope", R), v.$destroy(), v = null), d) {
                      var t = d.data("$uiViewAnim");
                      Qt.traceUIViewEvent("Animate out", t), w.leave(d, function() {
                        t.$$animLeave.resolve(), p = null
                      }), p = d, d = null
                    }
                  }()
              });
              d = c, (v = e).$emit("$viewContentLoaded", t || _), v.$eval(y)
            }
            Qt.traceUIViewEvent("Linking", R), f.data("$uiView", {
              $uiView: R
            }), b(), m = t.registerUIView(R), s.$on("$destroy", function() {
              Qt.traceUIViewEvent("Destroying/Unregistering", R), m()
            })
          }
        }
      };
    return u
  }], Kn.$inject = ["$compile", "$controller", "$transitions", "$view", "$q", "$timeout"];
  var Yn = "function" == typeof n.module("ui.router").component,
    Zn = 0;

  function Xn(t, e, r, n, i) {
    !P(r.$onInit) || i.viewDecl.component && Yn || r.$onInit();
    var o = kt(i.path).state.self,
      a = {
        bind: r
      };
    if (P(r.uiOnParamsChanged)) {
      var u = new ye(i.path).getResolvable("$transition$").data;
      n.$on("$destroy", e.onSuccess({}, function(t) {
        if (t !== u && -1 === t.exiting().indexOf(o)) {
          var e = t.params("to"),
            n = t.params("from"),
            i = t.treeChanges().to.map(function(t) {
              return t.paramSchema
            }).reduce(yt, []),
            a = t.treeChanges().from.map(function(t) {
              return t.paramSchema
            }).reduce(yt, []),
            s = i.filter(function(t) {
              var r = a.indexOf(t);
              return -1 === r || !a[r].type.equals(e[t.id], n[t.id])
            });
          if (s.length) {
            var c = s.map(function(t) {
                return t.id
              }),
              f = ft(e, function(t, e) {
                return -1 !== c.indexOf(e)
              });
            r.uiOnParamsChanged(f, t)
          }
        }
      }, a))
    }
    if (P(r.uiCanExit)) {
      var s = Zn++,
        c = "_uiCanExitIds",
        f = function(t) {
          return !!t && (t[c] && !0 === t[c][s] || f(t.redirectedFrom()))
        },
        l = {
          exiting: o.name
        };
      n.$on("$destroy", e.onBefore(l, function(e) {
        var n, i = e[c] = e[c] || {};
        return f(e) || (n = t.when(r.uiCanExit(e))).then(function(t) {
          return i[s] = !1 !== t
        }), n
      }, a))
    }
  }
  n.module("ui.router.state").directive("uiView", Fn), n.module("ui.router.state").directive("uiView", Kn), n.module("ui.router.state").provider("$uiViewScroll", function() {
    var t = !1;
    this.useAnchorScroll = function() {
      t = !0
    }, this.$get = ["$anchorScroll", "$timeout", function(e, r) {
      return t ? e : function(t) {
        return r(function() {
          t[0].scrollIntoView()
        }, 0, !1)
      }
    }]
  });
  t.default = "ui.router", t.core = dn, t.watchDigests = Hn, t.getLocals = Un, t.getNg1ViewConfigFactory = vn, t.ng1ViewsBuilder = yn, t.Ng1ViewConfig = wn, t.StateProvider = Rn, t.UrlRouterProvider = Tn, t.fromJson = U, t.toJson = L, t.copy = M, t.forEach = B, t.extend = G, t.equals = W, t.identity = z, t.noop = J, t.createProxyFunctions = Q, t.inherit = K, t.inArray = Y, t._inArray = Z, t.removeFrom = X, t._removeFrom = tt, t.pushTo = et, t._pushTo = rt, t.deregAll = nt, t.defaults = it, t.mergeR = ot, t.ancestors = at, t.pick = ut, t.omit = st, t.pluck = ct, t.filter = ft, t.find = lt, t.mapObj = ht, t.map = pt, t.values = dt, t.allTrueR = vt, t.anyTrueR = mt, t.unnestR = yt, t.flattenR = gt, t.pushR = wt, t.uniqR = _t, t.unnest = $t, t.flatten = St, t.assertPredicate = Rt, t.assertMap = bt, t.assertFn = Et, t.pairs = Tt, t.arrayTuples = Ct, t.applyPairs = Pt, t.tail = kt, t._extend = Ot, t.sortBy = It, t.composeSort = Vt, t.silenceUncaughtInPromise = At, t.silentRejection = Ht, t.notImplemented = D, t.services = N, t.Glob = _, t.curry = i, t.compose = o, t.pipe = a, t.prop = u, t.propEq = s, t.parse = c, t.not = f, t.and = l, t.or = h, t.all = p, t.any = d, t.is = v, t.eq = m, t.val = y, t.invoke = g, t.pattern = w, t.isUndefined = b, t.isDefined = E, t.isNull = T, t.isNullOrUndefined = C, t.isFunction = P, t.isNumber = k, t.isString = O, t.isObject = x, t.isArray = j, t.isDate = I, t.isRegExp = V, t.isState = A, t.isInjectable = H, t.isPromise = q, t.Queue = qt, t.maxLength = $e, t.padString = Se, t.kebobString = Re, t.functionToString = be, t.fnToString = Ee, t.stringify = Pe, t.beforeAfterSubstr = ke, t.splitOnDelim = Oe, t.joinNeighborsR = xe, t.Trace = Jt, t.trace = Qt, t.Param = ue, t.ParamTypes = Ie, t.StateParams = Ve, t.ParamType = ne, t.PathNode = se, t.PathUtils = ce, t.resolvePolicies = he, t.defaultResolvePolicy = fe, t.Resolvable = le, t.NATIVE_INJECTOR_TOKEN = me, t.ResolveContext = ye, t.resolvablesBuilder = Me, t.StateBuilder = Be, t.StateObject = $, t.StateMatcher = Ge, t.StateQueueManager = We, t.StateRegistry = ze, t.StateService = Vr, t.TargetState = Kt, t.HookBuilder = re, t.matchState = Xt, t.RegisteredHook = te, t.makeEvent = ee, t.Rejection = Nt, t.Transition = _e, t.TransitionHook = Zt, t.TransitionEventType = kr, t.defaultTransOpts = jr, t.TransitionService = Ir, t.UrlMatcher = Ke, t.UrlMatcherFactory = Ye, t.UrlRouter = rr, t.UrlRuleFactory = Ze, t.BaseUrlRule = Xe, t.UrlService = hr, t.ViewService = ir, t.UIRouterGlobals = or, t.UIRouter = dr, t.$q = Ar, t.$injector = Nr, t.BaseLocationServices = Xr, t.HashLocationService = en, t.MemoryLocationService = nn, t.PushStateLocationService = an, t.MemoryLocationConfig = un, t.BrowserLocationConfig = sn, t.splitHash = Ur, t.splitQuery = Lr, t.splitEqual = Mr, t.trimHashVal = Br, t.keyValsToObjectR = Gr, t.getParams = Wr, t.parseUrl = zr, t.buildUrl = Jr, t.locationPluginFactory = Qr, t.servicesPlugin = cn, t.hashLocationPlugin = fn, t.pushStateLocationPlugin = ln, t.memoryLocationPlugin = hn, t.UIRouterPluginBase = pn, Object.defineProperty(t, "__esModule", {
    value: !0
  })
});
